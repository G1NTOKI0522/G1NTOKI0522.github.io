<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="G1NTOKI">
<meta property="og:url" content="https://g1ntoki0522.github.io/index.html">
<meta property="og:site_name" content="G1NTOKI">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="G1NTOKI">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://g1ntoki0522.github.io/"/>





  <title>G1NTOKI</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">G1NTOKI</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://g1ntoki0522.github.io/2018/05/12/NEUTV-第二周开发日记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="G1NTOKI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sidebarAvatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="G1NTOKI">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/12/NEUTV-第二周开发日记/" itemprop="url">NEUTV 第二周开发日记</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-12T16:28:40+08:00">
                2018-05-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://github.com/xfangfang/NEUTV_UWP" target="_blank" rel="external">NEUTV项目</a></p>
<h1 id="方悦成"><a href="#方悦成" class="headerlink" title="方悦成"></a>方悦成</h1><h2 id="主要工作"><a href="#主要工作" class="headerlink" title="主要工作"></a>主要工作</h2><p>添加下载功能，完善弹幕</p>
<h2 id="提交日志"><a href="#提交日志" class="headerlink" title="提交日志"></a>提交日志</h2><h3 id="2018-5-4"><a href="#2018-5-4" class="headerlink" title="2018/5/4"></a>2018/5/4</h3><ul>
<li>修改视频下载部分的代码结构，新建了downloadManager类进行下载处理</li>
</ul>
<h1 id="李书缘"><a href="#李书缘" class="headerlink" title="李书缘"></a>李书缘</h1><h2 id="主要工作-1"><a href="#主要工作-1" class="headerlink" title="主要工作"></a>主要工作</h2><p>完成弹幕功能</p>
<h2 id="提交日志-1"><a href="#提交日志-1" class="headerlink" title="提交日志"></a>提交日志</h2><p>p.s.提交中的下载功能是小方完成的，收藏功能是邓翼完成的。</p>
<h3 id="2018-05-05"><a href="#2018-05-05" class="headerlink" title="2018/05/05"></a>2018/05/05</h3><ul>
<li>完善下载进度显示，添加了收藏功能</li>
<li>修改弹幕添加位置，下载功能</li>
<li>完成连接服务器，完成直播功能</li>
<li>根据播放位置实时添加弹幕</li>
<li>监听当前播放位置来添加弹幕</li>
<li>添加弹幕开关，直播，下载按钮</li>
</ul>
<h3 id="2018-05-04"><a href="#2018-05-04" class="headerlink" title="2018/05/04"></a>2018/05/04</h3><ul>
<li>尝试连接服务器 格式错误</li>
<li>添加弹幕的播放和暂停</li>
</ul>
<h3 id="2018-05-03"><a href="#2018-05-03" class="headerlink" title="2018/05/03"></a>2018/05/03</h3><ul>
<li>添加弹幕及全屏功能</li>
</ul>
<h1 id="张代锟"><a href="#张代锟" class="headerlink" title="张代锟"></a>张代锟</h1><h2 id="主要工作-2"><a href="#主要工作-2" class="headerlink" title="主要工作"></a>主要工作</h2><p>主要工作是服务器端的开发</p>
<ul>
<li>运用python和web.py框架搭建的简易服务器端</li>
<li>修正了一些返回模板文件的格式错误</li>
<li>将xml文件转化为C#对象</li>
<li>修正弹幕类型错误</li>
<li>部署服务器端代码于Ubuntu16.04的主机中，并修改一些bug</li>
</ul>
<h2 id="提交日志-2"><a href="#提交日志-2" class="headerlink" title="提交日志"></a>提交日志</h2><h3 id="2018-05-03-1"><a href="#2018-05-03-1" class="headerlink" title="2018/05/03"></a>2018/05/03</h3><ul>
<li>将服务端代码部署在Ubuntu主机上</li>
</ul>
<h3 id="2018-05-04-1"><a href="#2018-05-04-1" class="headerlink" title="2018/05/04"></a>2018/05/04</h3><ul>
<li>add xml translator without testing: 增加一个转换函数，将服务端发送过来的xml文件转化为Danmaku对象的列表, 但是没有通过测试</li>
<li>fix the format problem: 修正xml格式错误</li>
<li>merge the media branch: 合并弹幕媒体播放器分支</li>
</ul>
<h3 id="2018-05-05-1"><a href="#2018-05-05-1" class="headerlink" title="2018/05/05"></a>2018/05/05</h3><ul>
<li>fix the bug that lead to the type err for danmakulist generation: 修正了使得弹幕列表生成格式错误的bug</li>
<li>merge the remote repo: 更新自己的分支</li>
</ul>
<h1 id="邓翼"><a href="#邓翼" class="headerlink" title="邓翼"></a>邓翼</h1><h2 id="主要工作-3"><a href="#主要工作-3" class="headerlink" title="主要工作"></a>主要工作</h2><p>收藏功能</p>
<h2 id="提交日志-3"><a href="#提交日志-3" class="headerlink" title="提交日志"></a>提交日志</h2><p>p.s.当时由于网络原因，通过李书缘的github账号提交了收藏功能。<br>p.p.s 再次由于网络原因，小方用邓翼账号提交了他的更改。</p>
<h3 id="2018-05-05-2"><a href="#2018-05-05-2" class="headerlink" title="2018/05/05"></a>2018/05/05</h3><ul>
<li>桌面图标居中&amp;修复弹幕服务器不存在时不可回看的bug</li>
</ul>
<h1 id="提交截图"><a href="#提交截图" class="headerlink" title="提交截图"></a>提交截图</h1><p><img src="/images/6-0.png" alt="ScreenShot"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://g1ntoki0522.github.io/2018/04/27/NEUTV-第一周开发日记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="G1NTOKI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sidebarAvatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="G1NTOKI">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/27/NEUTV-第一周开发日记/" itemprop="url">NEUTV 第一周开发日记</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-27T14:02:18+08:00">
                2018-04-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://github.com/xfangfang/NEUTV_UWP" target="_blank" rel="external">NEUTV项目</a></p>
<h1 id="方悦成"><a href="#方悦成" class="headerlink" title="方悦成"></a>方悦成</h1><h2 id="主要工作"><a href="#主要工作" class="headerlink" title="主要工作"></a>主要工作</h2><p>搭建应用的基础框架和主要功能</p>
<h2 id="提交日志"><a href="#提交日志" class="headerlink" title="提交日志"></a>提交日志</h2><h3 id="2018-03-30"><a href="#2018-03-30" class="headerlink" title="2018/03/30"></a>2018/03/30</h3><ul>
<li>加入简单的播放器</li>
</ul>
<h3 id="2018-04-08"><a href="#2018-04-08" class="headerlink" title="2018/04/08"></a>2018/04/08</h3><ul>
<li>完成观看直播的基本功能</li>
</ul>
<h3 id="2018-04-12"><a href="#2018-04-12" class="headerlink" title="2018/04/12"></a>2018/04/12</h3><ul>
<li>加入回看节目功能</li>
</ul>
<h3 id="2018-04-17"><a href="#2018-04-17" class="headerlink" title="2018/04/17"></a>2018/04/17</h3><ul>
<li>修复回看节目时，回看列表第二次进入不显示的问题</li>
</ul>
<h3 id="2018-04-24"><a href="#2018-04-24" class="headerlink" title="2018/04/24"></a>2018/04/24</h3><ul>
<li>增加下载m3u8文件的功能</li>
</ul>
<h3 id="2018-04-26"><a href="#2018-04-26" class="headerlink" title="2018/04/26"></a>2018/04/26</h3><ul>
<li>完成单线程下载视频，并合成为单个视频文件</li>
</ul>
<h3 id="2018-04-27"><a href="#2018-04-27" class="headerlink" title="2018/04/27"></a>2018/04/27</h3><ul>
<li>支持并行下载</li>
<li>下载时 自动选择线程数量</li>
</ul>
<h1 id="李书缘"><a href="#李书缘" class="headerlink" title="李书缘"></a>李书缘</h1><h2 id="主要工作-1"><a href="#主要工作-1" class="headerlink" title="主要工作"></a>主要工作</h2><p>负责首页电视墙预览，弹幕前端</p>
<h2 id="提交日志-1"><a href="#提交日志-1" class="headerlink" title="提交日志"></a>提交日志</h2><h3 id="2018-04-19"><a href="#2018-04-19" class="headerlink" title="2018/04/19"></a>2018/04/19</h3><ul>
<li>增加首页图片预览效果</li>
<li>修复 通过首页预览墙进入播放界面无法播放的问题</li>
</ul>
<h1 id="张代锟"><a href="#张代锟" class="headerlink" title="张代锟"></a>张代锟</h1><h2 id="主要工作-2"><a href="#主要工作-2" class="headerlink" title="主要工作"></a>主要工作</h2><p>主要工作服务器端的开发</p>
<ul>
<li>运用python和web.py框架搭建的简易服务器端</li>
<li>数据库使用sqlite3</li>
<li>主要用来储存客户端发过来的弹幕和评论</li>
<li>可以根据客户端的请求通过web.py模板生成弹幕文件(xml)和评论文件(xml)</li>
</ul>
<h2 id="提交日志-2"><a href="#提交日志-2" class="headerlink" title="提交日志"></a>提交日志</h2><h3 id="2018-04-13"><a href="#2018-04-13" class="headerlink" title="2018/04/13"></a>2018/04/13</h3><ul>
<li>add ignore file: 增加ignore文件来忽视编译过后的文件</li>
<li>init the backend server with web.py framwork: 初步建立服务端，使用web.py框架</li>
<li>add some models with some utils function: 增加一些数据库操作的工具函数，并且增加模板类。模仿django的项目结构</li>
<li>add a simple migration script: 增加一个python脚本用以建立数据库，方便客户端开发人员测试</li>
<li>add a database file: 建立数据库并且进行初步测试</li>
</ul>
<h3 id="2018-04-14"><a href="#2018-04-14" class="headerlink" title="2018/04/14"></a>2018/04/14</h3><ul>
<li>add a simple connection pool and some database utils: 考虑到有可能有多个客户端接入，为了防止服务器端频繁的链接数据库，增加一个简易的连接池，增加访问效率（虽然很可能作用不是特别明显）</li>
<li>fix some bug and ignore the thread diff when init a connection to sqlite: 修正了一些多线程链接数据库的bug，稍微优化了一下连接池函数</li>
<li>add query function and interface to generate xml, but file-generation  functions were still not finished: 增加一个搜索函数，根据前端发来的请求来生成xml文件，使用web.py的模板系统生成xml，但是有一些bug赏未解决</li>
<li>add some template with bugs: 增加一些模板文件用来生成xml，但是生成的时候遇上了一些bug</li>
<li>fix some bugs and spelling errors, enable frontend to post beging datetime and enddatetime to get the xml that is generated by the query functions linking to database: 修改正了一些bug和拼写错误，允许客户端发送初始日期和结束日期来获取弹幕文件和评论文件</li>
<li>extends search key named ‘channel_id’… : 增加搜索的关键字，允许客户端通过开始与结束时间，还有频道来获取弹幕和评论文件</li>
</ul>
<h3 id="2018-04-15"><a href="#2018-04-15" class="headerlink" title="2018/04/15"></a>2018/04/15</h3><ul>
<li>add markdown doc …: 增加一个markdown 文档来帮助客户端开发人员部署并且进行本地测试</li>
<li>update readme.md: 更新readme文档</li>
</ul>
<h3 id="2018-04-16"><a href="#2018-04-16" class="headerlink" title="2018/04/16"></a>2018/04/16</h3><ul>
<li>change the format of templates: 修改生成xml的文档的格式</li>
<li>merge the main branch: 合并主分支</li>
</ul>
<h3 id="2018-04-17-1"><a href="#2018-04-17-1" class="headerlink" title="2018/04/17"></a>2018/04/17</h3><ul>
<li>alter table danmaku and add a field named ‘type’: 增加一个字段用来描述弹幕类型，修改生成的弹幕文件xml的模板格式，并且修改了生成数据库的脚本migrate.py用来帮助客户端开发人员测试。</li>
<li>merge the main branch: 合并主分支</li>
</ul>
<h3 id="2018-04-18-Now"><a href="#2018-04-18-Now" class="headerlink" title="2018/04/18 - Now"></a>2018/04/18 - Now</h3><ul>
<li>服务端开发进入休眠阶段(摸了摸了</li>
</ul>
<h1 id="提交截图"><a href="#提交截图" class="headerlink" title="提交截图"></a>提交截图</h1><p><img src="/images/5--1.png" alt="ScreenShot"><br><img src="/images/5-0.png" alt="ScreenShot"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://g1ntoki0522.github.io/2018/04/12/NaiveMediaPlayer2-0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="G1NTOKI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sidebarAvatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="G1NTOKI">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/12/NaiveMediaPlayer2-0/" itemprop="url">NaiveMediaPlayer2.0</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-12T23:05:51+08:00">
                2018-04-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>在之前的基础上添加两个功能，一个是从URL源直接播放文件，另一个是先缓存在系统音乐文件夹下然后再播放。<br>经历一番波折之后完成了<a href="https://github.com/G1NTOKI0522/UWP" target="_blank" rel="external">NaiveMediaPlayer2.0</a>。打开首界面如下<br><img src="/images/5-00.png" alt="mainpage"><br>在CommandBar添加了一个按钮，点击会出现二级界面<br><img src="/images/5-01.png" alt="secondaryPage"><br>在文本框中输入URL，点击<code>justPlay</code>按钮，播放器开始播放NEUSong并显示相应title,直接播放，所以本地音乐文件夹没有文件。<br><img src="/images/5-02.png" alt="justPlay"><br>点击cacheThenPlay按钮，稍等片刻，文件即会被下载到本地音乐文件夹，可在播放器开始播放。<br><img src="/images/5-03.png" alt="cache"></p>
<h2 id="从URL源直接播放"><a href="#从URL源直接播放" class="headerlink" title="从URL源直接播放"></a>从URL源直接播放</h2><p>首先想到的就是能否直接从URL源播放文件。根据上次测试播放本地文件的经验，试着将本地的URI改为给定的URL，写出如下代码，尝试能否播放。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var mediaSource = MediaSource.CreateFromUri(new Uri(&quot;http://www.neu.edu.cn/indexsource/neusong.mp3&quot;));</div><div class="line"></div><div class="line">Title.Text = mediaSource.Uri.ToString(); </div><div class="line">Title.Text = Title.Text.Substring(Title.Text.LastIndexOf(&apos;/&apos;) + 1);</div><div class="line">myPlayer.Source = mediaSource;</div><div class="line">mediaSimple.SetMediaPlayer(myPlayer);</div></pre></td></tr></table></figure></p>
<p>运行可以直接播放。第一个功能完成。</p>
<h2 id="创建新窗口"><a href="#创建新窗口" class="headerlink" title="创建新窗口"></a>创建新窗口</h2><p>然后开始想怎样设计交互方式来实现对两个功能的选择，类比于openFile时在新窗口选择文件，所以初步设想是点击playOnline按钮后，弹出新窗口。<br>在新窗口放一个<code>pivot</code>，有<code>justPlay</code>,<code>cacheThenPlay</code>两个item，做成类似于选项卡的效果。于是参考<a href="https://docs.microsoft.com/zh-cn/windows/uwp/layout/show-multiple-views" target="_blank" rel="external">微软文档 Multi-views </a>和一篇<a href="https://blog.csdn.net/wind_white/article/details/64442814" target="_blank" rel="external">blog</a>写出如下代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">private void AppBarButton_Click_1(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">	CoreApplicationView newView = CoreApplication.CreateNewView();</div><div class="line">    int newViewId = 0;</div><div class="line">    await newView.Dispatcher.RunAsync(CoreDispatcherPriority.Normal, () =&gt;</div><div class="line">    &#123;</div><div class="line">         Frame frame = new Frame();</div><div class="line">         frame.Navigate(sourcePageType: typeof(SecondaryPage));</div><div class="line">         Window.Current.Content = frame;</div><div class="line">         // You have to activate the window in order to show it later.</div><div class="line">         Window.Current.Activate();</div><div class="line"></div><div class="line">         newViewId = ApplicationView.GetForCurrentView().Id;</div><div class="line">    &#125;);</div><div class="line">    bool viewShown = await ApplicationViewSwitcher.TryShowAsStandaloneAsync(newViewId);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>多窗口就是在多个view之间切换，将新Page通过Window.Current.Activate()设为active状态。至此已经可以通过点击按钮弹出新窗口了。在新的页面设置布局，参考<a href="https://docs.microsoft.com/en-us/windows/uwp/design/controls-and-patterns/tabs-pivot" target="_blank" rel="external">微软 Pivot 文档</a>写出如下代码<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Page</span></span></div><div class="line">    <span class="attr">x:Class</span>=<span class="string">"NaiveMediaPlayer.SecondaryPage"</span></div><div class="line">    <span class="attr">xmlns</span>=<span class="string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></div><div class="line">    <span class="attr">xmlns:x</span>=<span class="string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></div><div class="line">    <span class="attr">xmlns:local</span>=<span class="string">"using:NaiveMediaPlayer"</span></div><div class="line">    <span class="attr">xmlns:d</span>=<span class="string">"http://schemas.microsoft.com/expression/blend/2008"</span></div><div class="line">    <span class="attr">xmlns:mc</span>=<span class="string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></div><div class="line">    <span class="attr">mc:Ignorable</span>=<span class="string">"d"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">Background</span>=<span class="string">"&#123;ThemeResource ApplicationPageBackgroundThemeBrush&#125;"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Pivot</span> <span class="attr">Title</span>=<span class="string">"playOnlineSource"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">PivotItem</span> <span class="attr">Header</span>=<span class="string">"JustPlay"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">Grid</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"*"</span> /&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"Auto"</span> /&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"Auto"</span> /&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"*"</span> /&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">TextBox</span> <span class="attr">Name</span>=<span class="string">"input1"</span> <span class="attr">Header</span>=<span class="string">"URL:"</span> <span class="attr">PlaceholderText</span>=<span class="string">"http://..."</span> <span class="attr">Grid.Row</span>=<span class="string">"1"</span>/&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Grid.Row</span>=<span class="string">"2"</span> <span class="attr">Orientation</span>=<span class="string">"Horizontal"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Content</span>=<span class="string">"OK"</span> <span class="attr">Click</span> =<span class="string">"Button_Click_1"</span>  <span class="attr">Margin</span>=<span class="string">"50"</span>/&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Content</span>=<span class="string">"Cancel"</span> <span class="attr">Click</span> =<span class="string">"Button_Click_2"</span>  <span class="attr">Margin</span>=<span class="string">"50"</span>/&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></div><div class="line">                   </div><div class="line">                <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">PivotItem</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">PivotItem</span> <span class="attr">Header</span>=<span class="string">"CacheThenPlay"</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">Grid</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"*"</span> /&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"Auto"</span> /&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"Auto"</span> /&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"*"</span> /&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">TextBox</span> <span class="attr">Name</span> =<span class="string">"input2"</span> <span class="attr">Header</span>=<span class="string">"URL:"</span> <span class="attr">PlaceholderText</span>=<span class="string">"http://..."</span> <span class="attr">Grid.Row</span>=<span class="string">"1"</span>/&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Grid.Row</span>=<span class="string">"2"</span> <span class="attr">Orientation</span>=<span class="string">"Horizontal"</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Content</span>=<span class="string">"OK"</span> <span class="attr">Click</span> =<span class="string">"Button_Click_3"</span>  <span class="attr">Margin</span>=<span class="string">"50"</span>/&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Content</span>=<span class="string">"Cancel"</span> <span class="attr">Click</span> =<span class="string">"Button_Click_4"</span>  <span class="attr">Margin</span>=<span class="string">"50"</span>/&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">PivotItem</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Pivot</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">Page</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>每个pivot item 都有一个Textbox来输入URL，下方是两个按钮<code>OK</code>, <code>Cancel</code>。点击取消按钮时应该将新的窗口关闭，写这个事件时完全找不到参考的资料啥的，最后还是类比着<code>Window.Current.Activate()</code>，挨着看Window的方法列表。终于找到它！<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">private void Button_Click_2(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">    Window.Current.Close();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然后在写OK按钮的时候，发现自己深陷传值的大坑无法自拔。参考各种博客尝试了传参<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">frame.Navigate(sourcePageType: typeof(SecondaryPage),Parameter: mediaPlayer);</div></pre></td></tr></table></figure></p>
<p>但是不行，新page就是没有这个变量。又尝试声明全局变量，是避免传参的问题了，但是在一开始就把MediaPlayerElement和空Source的MediaPlayer绑定了，之后再修改Source仍然不能播放。</p>
<p>这个问题，第二天决定换个交互方式来解决，不用新窗口，直接弹一个spliteView来搞。将两个功能变成两个按钮，同样是二选一的逻辑。<br>在MainPage.xaml中添加如下代码：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">SplitView</span> <span class="attr">IsPaneOpen</span>=<span class="string">"False"</span></span></div><div class="line">                         <span class="attr">DisplayMode</span>=<span class="string">"Inline"</span></div><div class="line">                       <span class="attr">PanePlacement</span>=<span class="string">"Right"</span></div><div class="line">                         <span class="attr">OpenPaneLength</span>=<span class="string">"400"</span> <span class="attr">Name</span>=<span class="string">"choice"</span> <span class="attr">Grid.Row</span>=<span class="string">"1"</span> &gt;</div><div class="line">                <span class="tag">&lt;<span class="name">SplitView.Pane</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">Grid</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">Grid.ColumnDefinitions</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">"auto"</span>/&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">"auto"</span>/&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">Grid.ColumnDefinitions</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"*"</span>/&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"auto"</span>/&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"auto"</span> /&gt;</span></div><div class="line">                            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"*"</span>/&gt;</span></div><div class="line">                        <span class="tag">&lt;/<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">TextBox</span> <span class="attr">Name</span> =<span class="string">"inputUrl"</span> <span class="attr">Header</span>=<span class="string">"URL:"</span> <span class="attr">PlaceholderText</span>=<span class="string">"http://..."</span> <span class="attr">Grid.Row</span>=<span class="string">"1"</span> <span class="attr">Grid.ColumnSpan</span>=<span class="string">"2"</span></span></div><div class="line">                                 <span class="attr">Width</span> =<span class="string">"268"</span></div><div class="line">                                 <span class="attr">VerticalAlignment</span>=<span class="string">"Center"</span> <span class="attr">HorizontalAlignment</span>=<span class="string">"Center"</span>/&gt;</div><div class="line">                        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Content</span>=<span class="string">"justPlay"</span> <span class="attr">Click</span> =<span class="string">"Button_Click"</span>  <span class="attr">Margin</span>=<span class="string">"50"</span> <span class="attr">Grid.Row</span>=<span class="string">"2"</span> <span class="attr">Grid.Column</span>=<span class="string">"0"</span>/&gt;</span></div><div class="line">                        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Content</span>=<span class="string">"cacheThenPlay"</span> <span class="attr">Click</span> =<span class="string">"Button_Click_1"</span>  <span class="attr">Margin</span>=<span class="string">"50"</span> <span class="attr">Grid.Row</span>=<span class="string">"2"</span> <span class="attr">Grid.Column</span>=<span class="string">"1"</span>/&gt;</span></div><div class="line">                    <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></div><div class="line"></div><div class="line">                    </div><div class="line">                <span class="tag">&lt;/<span class="name">SplitView.Pane</span>&gt;</span></div><div class="line"></div><div class="line">            <span class="tag">&lt;/<span class="name">SplitView</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>仍然不明白，讲道理Window和page用的都是一个navigate 方法，page间直接传参就行，怎么这个window就不可以吶。可能是当时写的有问题。不过这里传参只能传一个，还是不能实现之前设想的效果。还是换spliteView吧。</p>
<h2 id="缓存文件"><a href="#缓存文件" class="headerlink" title="缓存文件"></a>缓存文件</h2><p>缓存文件就是读写文件，通过参看<a href="https://docs.microsoft.com/en-us/windows/uwp/files/quickstart-reading-and-writing-files" target="_blank" rel="external">微软 Create, write, and read a file 文档</a>，需要先new 一个 folder，然后调用folder的方法在其路径下新建文件。<br>又参考<a href="https://docs.microsoft.com/en-us/windows/uwp/files/quickstart-managing-folders-in-the-music-pictures-and-videos-libraries" target="_blank" rel="external">微软 Files and folders in the Music, Pictures, and Videos libraries 文档</a>得知可用如下代码获得Folder：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var myPictures = await Windows.Storage.StorageLibrary.GetLibraryAsync(Windows.Storage.KnownLibraryId.Pictures);</div></pre></td></tr></table></figure></p>
<p>写出如下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">private async void Button_Click_1(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">	choice.IsPaneOpen = false;</div><div class="line">    String inputU = inputUrl.Text.ToString();</div><div class="line">    if (inputU == &quot;&quot;) return;</div><div class="line">    var myfolder = KnownFolders.MusicLibrary;</div><div class="line">	String fileName = inputU.Substring(inputU.LastIndexOf(&apos;/&apos;) + 1);</div><div class="line">    StorageFile cacheFile = await myfolder.CreateFileAsync(fileName,CreationCollisionOption.ReplaceExisting);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>但是只有这样是不行的，又参考这篇<a href="https://blog.csdn.net/lindexi_gd/article/details/49007841" target="_blank" rel="external">blog</a>了解到，想要使用系统文件夹，需要设置<code>应用程序</code>-<code>包清单</code>-勾选<code>音乐库</code>。解决权限不够的问题。<br>创建文件之后怎么将URL源的文件写入创建的文件呢？研究了好大会儿写文件，但是没有从URL源直接写的。然后尝试直接从URL源创建文件，也没啥资料，就是各种试StorageFile的方法列表里带Uri的方法。找到一个<code>StorageFile.CreateStreamedFileFromUriAsync()</code>的方法，然鹅直接用会抛异常。<br>然后就又搜索这个方法的资料，然后！非常意外的在Stack Overflow找到了另一种解决方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">StorageFolder fileFolder = await ApplicationData.Current.LocalFolder.GetFolderAsync(&quot;MyFiles&quot;);</div><div class="line">StorageFile file =await fileFolder.CreateFileAsync(filename, CreationCollisionOption.ReplaceExisting);</div><div class="line"></div><div class="line">var download = new BackgroundDownloader().CreateDownload(source, file);</div><div class="line">await download.StartAsync();</div></pre></td></tr></table></figure></p>
<p>从源直接下载到目标文件，非常nice。写出如下代码解决了第二个功能：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">private async void Button_Click_1(object sender, RoutedEventArgs e)</div><div class="line">        &#123;</div><div class="line">            choice.IsPaneOpen = false;</div><div class="line">            String inputU = inputUrl.Text.ToString();</div><div class="line">            if (inputU == &quot;&quot;) return;</div><div class="line">            var myfolder = KnownFolders.MusicLibrary;</div><div class="line">            String fileName = inputU.Substring(inputU.LastIndexOf(&apos;/&apos;) + 1);</div><div class="line">            StorageFile cacheFile = await myfolder.CreateFileAsync(fileName,CreationCollisionOption.ReplaceExisting);</div><div class="line">           </div><div class="line">            var download = new BackgroundDownloader().CreateDownload(new Uri(inputU), cacheFile);</div><div class="line">            await download.StartAsync();</div><div class="line"></div><div class="line">            var cacheMediaSource = MediaSource.CreateFromStorageFile(cacheFile);</div><div class="line">            myPlayer.Source = cacheMediaSource;</div><div class="line">            mediaSimple.SetMediaPlayer(myPlayer);</div><div class="line">            Title.Text = fileName;</div><div class="line">        &#125;</div></pre></td></tr></table></figure></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>出现错误时还是要认真研究报错信息哇，这样才能更快解决问题；<br>回看代码感觉犯了老师第一节课说的错误，一个button为什么要知道怎么获取json哇。同样这里一个button为什么要知道怎么从URL下载文件，怎么创建文件，设置播放器哇。没有好好封装起来。敲代码的时候只是简单的想着实现功能就好，没有考虑代码的结构啥的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://g1ntoki0522.github.io/2018/04/09/The-Plan-of-Our-Final-Project-IPV6-TV-Player/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="G1NTOKI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sidebarAvatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="G1NTOKI">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/09/The-Plan-of-Our-Final-Project-IPV6-TV-Player/" itemprop="url">The Plan of Our Final Project,NEU-TV Player</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-09T11:26:34+08:00">
                2018-04-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>小组头脑风暴了几个idea，最终经过投票，在幽灵般的第五票下决定了我们的项目主题：<code>NEU-TV Player</code>。项目将在我们已有的视频播放器经验上进行开发，并添加一些有趣的功能。</p>
<h1 id="项目描述"><a href="#项目描述" class="headerlink" title="项目描述"></a>项目描述</h1><h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>一个基于东北大学IPV6视频直播源的弹幕视频播放器。</p>
<h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><h3 id="观看节目"><a href="#观看节目" class="headerlink" title="观看节目"></a>观看节目</h3><p>涵盖中央、地方各大卫视频道，内容覆盖电影、音乐、体育、卡通应有尽有。只要连接校园网，打开本应用，在电视墙内选择你中意的频道，轻轻一点尽享缤纷精彩。</p>
<h3 id="频道搜索"><a href="#频道搜索" class="headerlink" title="频道搜索"></a>频道搜索</h3><p>频道太多眼花缭乱找不到想要的那一个？有想看的节目却不知道是在哪个频道？想回看某部电影却忘了之前是在什么时候播出？只要点击搜索栏，输入你想看的频道或节目名称，我们为你锁定它！</p>
<h3 id="弹幕吐槽"><a href="#弹幕吐槽" class="headerlink" title="弹幕吐槽"></a>弹幕吐槽</h3><p>快乐分享给他人会加倍快乐，那么和别人一起吐槽就更是爽翻天啦。不管是背景科普还是高能预警，通过弹幕分享你的观看体验，即使是一个人也能享受大家一起看电视的快乐！</p>
<h3 id="收藏回看"><a href="#收藏回看" class="headerlink" title="收藏回看"></a>收藏回看</h3><p>最近在追某项比赛，然而每次都要搜索体育频道很麻烦呐！不要急，收藏这个频道，让你直接追上比赛热点。<br>最近在追某部剧，然鹅某一天学业繁忙漏看了！不要方，点开节目单回看即可，最长支持7天内的视频回看哟，可以养肥后周末一口气追更。</p>
<h2 id="特色"><a href="#特色" class="headerlink" title="特色"></a>特色</h2><p><img src="/images/4-video.png" alt="4-video"></p>
<h3 id="免流量"><a href="#免流量" class="headerlink" title="免流量"></a>免流量</h3><p>只要连接校园网，不登录账号也可直接观看视频。追剧看球再也不怕流量不够了！校园网完美覆盖，走到哪里看到哪里。</p>
<h3 id="无广告"><a href="#无广告" class="headerlink" title="无广告"></a>无广告</h3><p>超清流畅无码节目源点开即看，没有烦人的弹窗广告，也没有煎熬的等待90s，毕竟你的时间，非常宝贵。</p>
<h3 id="可互动"><a href="#可互动" class="headerlink" title="可互动"></a>可互动</h3><p>通过弹幕和小伙伴分享自己的观影体验，吐槽视频的各种梗，你的弹幕可能比视频更加好玩！</p>
<h3 id="可补漏"><a href="#可补漏" class="headerlink" title="可补漏"></a>可补漏</h3><p>收藏你喜欢的频道，免去搜索的麻烦。回看一周内的视频，错过直播也不怕！</p>
<h1 id="项目设计"><a href="#项目设计" class="headerlink" title="项目设计"></a>项目设计</h1><h2 id="主界面"><a href="#主界面" class="headerlink" title="主界面"></a>主界面</h2><p><img src="/images/4-design1.png" alt="4-design1"><br>上方是标签页，通过标签页来对不同类别频道进行分类展示。标签页右侧是一个小的搜索栏。标签页下是页面主体，通过照片墙的方式来展示该类别的各个频道。点击照片即可进入对应频道观看视频。</p>
<h2 id="搜索页"><a href="#搜索页" class="headerlink" title="搜索页"></a>搜索页</h2><p><img src="/images/4-design2.png" alt="4-design2"><br>通过点击主页面的搜索栏可以转到搜索功能，动画是搜索栏向左延长横跨整个页面，上方的标签页消失，下方照片墙展示搜索结果。</p>
<h2 id="播放页"><a href="#播放页" class="headerlink" title="播放页"></a>播放页</h2><p><img src="/images/4-design3.png" alt="4-design3"><br>播放页面主要分为两部分，左侧为节目单，右侧为播放器。左侧，通过标签页展示周一到周日七天的节目单，对应日期的节目单通过垂直方向的列表显示，点击某一节目即可在播放器中回看该节目。<br>右侧，播放器类似于普通播放器，有播放/暂停按钮，进度条，音量调整，全屏按钮等。播放器下方是弹幕功能区。主要有一个文本编辑框和发送按钮构成 。文本框内输入文字，并选择不同的弹幕格式，然后点击发送按钮即可发送弹幕。</p>
<h1 id="市场调查"><a href="#市场调查" class="headerlink" title="市场调查"></a>市场调查</h1><p>小方对三位小伙伴进行了采访。先通过视频介绍我们的App，然后提问一些相关问题来帮助我们进行调整，最后将视频剪辑打码发布。<br><a href="https://www.bilibili.com/video/av21552408" target="_blank" rel="external">一个制作精良超级棒的视频</a></p>
<iframe src="//player.bilibili.com/player.html?aid=21552408&cid=35492549&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" width="600px" height="480px"> </iframe>

<p>但是分析采访内容，大家对我们的鼓励支持远远大于批评和建议，我们自己又深刻反思分析了一下，提出如下改进：</p>
<h2 id="搜索页面改进"><a href="#搜索页面改进" class="headerlink" title="搜索页面改进"></a>搜索页面改进</h2><p>搜索功能应当细化到具体节目才更有意义，但是照片墙只能展示到频道。所以对之前通过照片墙展示搜索结果的方式进行改进。点击搜索按钮后跳至新的页面，通过列表展示搜索结果。</p>
<h2 id="播放控制改进"><a href="#播放控制改进" class="headerlink" title="播放控制改进"></a>播放控制改进</h2><p>在播放器上，因为新加了弹幕功能，所以相应的也要加上关闭弹幕的功能。需要重写控制器。</p>
<h1 id="技术分析"><a href="#技术分析" class="headerlink" title="技术分析"></a>技术分析</h1><p>在确定设计之后，代锟dalao根据设计图与讨论的功能，对每个页面可能用到的技术及实现方法进行了分析。</p>
<h2 id="主页面"><a href="#主页面" class="headerlink" title="主页面"></a>主页面</h2><p><img src="/images/4-design1.png" alt="4-design1"></p>
<h3 id="标签页"><a href="#标签页" class="headerlink" title="标签页"></a>标签页</h3><p>不得不说，我最喜欢的浏览器是firefox和chrome，尤其是chrome的标签页的设计实在是太讨喜了，一点也不拖泥带水。然而，我google了半天，没有找到等腰梯形可重叠标签页的uwp现有的成熟实现方案。捉急之下我询问了老师，<br>然后找到了类似的<a href="https://stackoverflow.com/questions/3565553/listbox-items-orientation-to-horizontal" target="_blank" rel="external">解决方案</a>。<br>大体的解决方案是这样的：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ListBox</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">ListBox.ItemsPanel</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">ItemsPanelTemplate</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Orientation</span>=<span class="string">"Horizontal"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">ItemsPanelTemplate</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">ListBox.ItemsPanel</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ListBox</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>用一个stackpanel做模板？大概是这个意思，把它水平放过来<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Style</span> <span class="attr">TargetType</span>=<span class="string">"ListBox"</span>&gt;</span><span class="xml"></span></div><div class="line">    <span class="comment">&lt;!-- Rest of the style --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">"ItemsPanel"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Setter.Value</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">ItemsPanelTemplate</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Orientation</span>=<span class="string">"Horizontal"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">ItemsPanelTemplate</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Setter.Value</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">Setter</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">Style</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>增加style<br>用一个水平方向排列的ListBox来解决标签页的问题，然而，仅仅拥有标签页是不够的</p>
<p>然而，这并不能解决这个问题<br><img src="/images/4-lablePage.png" alt="lablePage"></p>
<p>没错，根本无法实现这种边的交替效果，而且也不具有chrome的那种随着标签页增加而标签缩短的效果。<br>好菜啊，从没有学过uwp的我，居然要定制UI耶QAQ。<br>那算了，实际一点，先使用edge和firefox那种扁平化的风格堆叠吧，那个稍微简单，而且我们先不考虑标签页增加而标签缩短的问题。</p>
<h3 id="搜索栏"><a href="#搜索栏" class="headerlink" title="搜索栏"></a>搜索栏</h3><p>这个功能可以使用AutoSuggestBox来实现<br>basic code:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public sealed class AutoSuggestBox : ItemsControl, IAutoSuggestBox, IAutoSuggestBox2, IAutoSuggestBox3</div></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">AutoSuggestBox</span> <span class="attr">...</span>/&gt;</span></div></pre></td></tr></table></figure>
<p>官方demo :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">// C#</div><div class="line">private void AutoSuggestBox_TextChanged(AutoSuggestBox sender, AutoSuggestBoxTextChangedEventArgs args)</div><div class="line">&#123;</div><div class="line">    // Only get results when it was a user typing, </div><div class="line">    // otherwise assume the value got filled in by TextMemberPath </div><div class="line">    // or the handler for SuggestionChosen.</div><div class="line">    if (args.Reason == AutoSuggestionBoxTextChangeReason.UserInput)</div><div class="line">    &#123;</div><div class="line">        //Set the ItemsSource to be your filtered dataset</div><div class="line">        //sender.ItemsSource = dataset;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">private void AutoSuggestBox_SuggestionChosen(AutoSuggestBox sender, AutoSuggestBoxSuggestionChosenEventArgs args)</div><div class="line">&#123;</div><div class="line">    // Set sender.Text. You can use args.SelectedItem to build your text string.</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">private void AutoSuggestBox_QuerySubmitted(AutoSuggestBox sender, AutoSuggestBoxQuerySubmittedEventArgs args)</div><div class="line">&#123;</div><div class="line">    if (args.ChosenSuggestion != null)</div><div class="line">    &#123;</div><div class="line">        // User selected an item from the suggestion list, take an action on it here.</div><div class="line">    &#125;</div><div class="line">    else</div><div class="line">    &#123;</div><div class="line">        // Use args.QueryText to determine what to do.</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这三个函数使用来分别监听前端搜索字体改变，搜索请求提交，给出建议等事件的处理函数</p>
<p>前端demo:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">AutoSuggestBox</span> <span class="attr">PlaceholderText</span>=<span class="string">"Search"</span> <span class="attr">QueryIcon</span>=<span class="string">"Find"</span> <span class="attr">Width</span>=<span class="string">"200"</span></span></div><div class="line">                <span class="attr">TextChanged</span>=<span class="string">"AutoSuggestBox_TextChanged"</span></div><div class="line">                <span class="attr">QuerySubmitted</span>=<span class="string">"AutoSuggestBox_QuerySubmitted"</span></div><div class="line">                <span class="attr">SuggestionChosen</span>=<span class="string">"AutoSuggestBox_SuggestionChosen"</span>/&gt;</div></pre></td></tr></table></figure></p>
<p>其中，PlaceholderText代表默认的占用字符串<br>Icon用的微软官方自带的图标<br>TextChanged=”AutoSuggestBox_TextChanged”<br>QuerySubmitted=”AutoSuggestBox_QuerySubmitted”<br>SuggestionChosen=”AutoSuggestBox_SuggestionChosen”<br>这三条对应后端的三个句柄(handle)，用来处理相应的事件demo(but)，原本在我们组dalao的设定中要点击搜索栏的时候搜索烂要有一个平滑延长的动画，然后标签页消失，最后过度到页面二的画面。我…..被水淹没不知所措。</p>
<p>后来了解到了一种解决方案，就是用StoryBoard做动画<br>具体的方法还没有做出来，但是还可以参考其他方案<br><a href="https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.media.animation.storyboard" target="_blank" rel="external">https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.media.animation.storyboard</a><br>basic demo<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public sealed class Storyboard : Timeline, IStoryboard</div></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Storyboard</span> <span class="attr">...</span>&gt;</span></div><div class="line">  oneOrMoreChildTimelines</div><div class="line"><span class="tag">&lt;/<span class="name">Storyboard</span>&gt;</span></div></pre></td></tr></table></figure>
<p>这种控件细究起来还是有很多拓展性的<br>先上官方demo:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">//using Windows.UI.Xaml.Media.Animation;</div><div class="line">        //using Windows.UI.Xaml.Shapes;</div><div class="line">        //using Windows.UI</div><div class="line"></div><div class="line">        private void Create_And_Run_Animation(object sender, RoutedEventArgs e)</div><div class="line">        &#123;</div><div class="line">            // Create a red rectangle that will be the target</div><div class="line">            // of the animation.</div><div class="line">            Rectangle myRectangle = new Rectangle();</div><div class="line">            myRectangle.Width = 200;</div><div class="line">            myRectangle.Height = 200;</div><div class="line">            SolidColorBrush myBrush = new SolidColorBrush(Colors.Red);</div><div class="line">            myRectangle.Fill = myBrush;</div><div class="line"></div><div class="line">            // Create the transform</div><div class="line">            TranslateTransform moveTransform = new TranslateTransform();</div><div class="line">            moveTransform.X = 0;</div><div class="line">            moveTransform.Y = 0;</div><div class="line">            myRectangle.RenderTransform = moveTransform;</div><div class="line"></div><div class="line">            // Add the rectangle to the tree.</div><div class="line">            LayoutRoot.Children.Add(myRectangle);</div><div class="line"></div><div class="line">            // Create a duration of 2 seconds.</div><div class="line">            Duration duration = new Duration(TimeSpan.FromSeconds(2));</div><div class="line">            // Create two DoubleAnimations and set their properties.</div><div class="line">            DoubleAnimation myDoubleAnimationX = new DoubleAnimation();</div><div class="line">            DoubleAnimation myDoubleAnimationY = new DoubleAnimation();</div><div class="line">            myDoubleAnimationX.Duration = duration;</div><div class="line">            myDoubleAnimationY.Duration = duration;</div><div class="line">            Storyboard justintimeStoryboard = new Storyboard();</div><div class="line">            justintimeStoryboard.Duration = duration;</div><div class="line">            justintimeStoryboard.Children.Add(myDoubleAnimationX);</div><div class="line">            justintimeStoryboard.Children.Add(myDoubleAnimationY);</div><div class="line">            Storyboard.SetTarget(myDoubleAnimationX, moveTransform);</div><div class="line">            Storyboard.SetTarget(myDoubleAnimationY, moveTransform);</div><div class="line"></div><div class="line">            // Set the X and Y properties of the Transform to be the target properties</div><div class="line">            // of the two respective DoubleAnimations.</div><div class="line">            Storyboard.SetTargetProperty(myDoubleAnimationX, &quot;X&quot;);</div><div class="line">            Storyboard.SetTargetProperty(myDoubleAnimationY, &quot;Y&quot;);</div><div class="line">            myDoubleAnimationX.To = 200;</div><div class="line">            myDoubleAnimationY.To = 200;</div><div class="line"></div><div class="line">            // Make the Storyboard a resource.</div><div class="line">            LayoutRoot.Resources.Add(&quot;justintimeStoryboard&quot;, justintimeStoryboard);</div><div class="line">            // Begin the animation.</div><div class="line">            justintimeStoryboard.Begin();</div><div class="line">        &#125;</div></pre></td></tr></table></figure></p>
<p>这个动画一共有四个部分，创建的时候也会有动画<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">x:Name</span>=<span class="string">"LayoutRoot"</span> &gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">StackPanel.Resources</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Storyboard</span> <span class="attr">x:Name</span>=<span class="string">"myStoryboard"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">DoubleAnimation</span> <span class="attr">From</span>=<span class="string">"1"</span> <span class="attr">To</span>=<span class="string">"6"</span> <span class="attr">Duration</span>=<span class="string">"00:00:6"</span> </span></div><div class="line">            <span class="attr">Storyboard.TargetName</span>=<span class="string">"rectScaleTransform"</span> </div><div class="line">            <span class="attr">Storyboard.TargetProperty</span>=<span class="string">"ScaleY"</span>&gt;</div><div class="line">                <span class="tag">&lt;<span class="name">DoubleAnimation.EasingFunction</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">BounceEase</span> <span class="attr">Bounces</span>=<span class="string">"2"</span> <span class="attr">EasingMode</span>=<span class="string">"EaseOut"</span> </span></div><div class="line">                            <span class="attr">Bounciness</span>=<span class="string">"2"</span> /&gt;</div><div class="line">                <span class="tag">&lt;/<span class="name">DoubleAnimation.EasingFunction</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">DoubleAnimation</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Storyboard</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">StackPanel.Resources</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Button that begins animation. --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Click</span>=<span class="string">"Animation_Begin"</span></span></div><div class="line">         <span class="attr">Margin</span>=<span class="string">"2"</span> <span class="attr">Content</span>=<span class="string">"Begin"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Button that pauses Animation. --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Click</span>=<span class="string">"Animation_Pause"</span></span></div><div class="line">         <span class="attr">Margin</span>=<span class="string">"2"</span> <span class="attr">Content</span>=<span class="string">"Pause"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Button that resumes Animation. --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Click</span>=<span class="string">"Animation_Resume"</span></span></div><div class="line">         <span class="attr">Margin</span>=<span class="string">"2"</span> <span class="attr">Content</span>=<span class="string">"Resume"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Button that stops Animation. Stopping the animation </span></div><div class="line">         returns the ellipse to its original location. --&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Click</span>=<span class="string">"Animation_Stop"</span></span></div><div class="line">         <span class="attr">Margin</span>=<span class="string">"2"</span> <span class="attr">Content</span>=<span class="string">"Stop"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Rectangle</span> <span class="attr">Fill</span>=<span class="string">"Blue"</span> <span class="attr">Width</span>=<span class="string">"200"</span> <span class="attr">Height</span>=<span class="string">"30"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Rectangle.RenderTransform</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">ScaleTransform</span> <span class="attr">x:Name</span>=<span class="string">"rectScaleTransform"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Rectangle.RenderTransform</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">Rectangle</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这个扩展性非常强，每一个事件发生都可以调用相对应的story board的产生的animation<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">private void Animation_Begin(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">    myStoryboard.Begin();</div><div class="line">&#125;</div><div class="line">private void Animation_Pause(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">    myStoryboard.Pause();</div><div class="line">&#125;</div><div class="line">private void Animation_Resume(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">    myStoryboard.Resume();</div><div class="line">&#125;</div><div class="line">private void Animation_Stop(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">    myStoryboard.Stop();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当我们设定好动画之后，就可以体验到那种顺滑的感觉</p>
<h2 id="搜索页面"><a href="#搜索页面" class="headerlink" title="搜索页面"></a>搜索页面</h2><p><img src="/images/4-design2.png" alt="4-design2"></p>
<h3 id="搜索栏-1"><a href="#搜索栏-1" class="headerlink" title="搜索栏"></a>搜索栏</h3><p>这个我之前已经提到过了，这里不再细讲</p>
<h3 id="节目缩略图"><a href="#节目缩略图" class="headerlink" title="节目缩略图"></a>节目缩略图</h3><p>这个图片来源主要来自于后端提供，简单来说，其实就是<a href="https://www.cnblogs.com/bestckk/p/6035139.html" target="_blank" rel="external">Image</a>这个博客就有一个很好的demo来展示如何显示出一个图片墙。<br>不过他是用的某种选择文件夹的方式，我们改改也就可以用了，用服务器的某个文件夹这样？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">StorageFile fileLocal = await StorageFile.GetFileFromApplicationUriAsync(new Uri(&quot;ms-appdata:///local/account/&quot; + ImageHelper.folderStr + &quot;.json&quot;));</div><div class="line">            if (fileLocal != null)</div><div class="line">            &#123;</div><div class="line">                try</div><div class="line">                &#123;</div><div class="line">                    //读取本地文件内容，并且反序列化</div><div class="line">                    using (IRandomAccessStream readStream = await fileLocal.OpenAsync(FileAccessMode.Read))</div><div class="line">                    &#123;</div><div class="line">                        using (DataReader dataReader = new DataReader(readStream))</div><div class="line">                        &#123;</div><div class="line">                            UInt64 size = readStream.Size;</div><div class="line">                            if (size &lt;= UInt32.MaxValue)</div><div class="line">                            &#123;</div><div class="line">                                await dataReader.LoadAsync(sizeof(Int32));</div><div class="line">                                Int32 stringSize = dataReader.ReadInt32();</div><div class="line">                                await dataReader.LoadAsync((UInt32)stringSize);</div><div class="line">                                string fileContent = dataReader.ReadString((uint)stringSize);</div><div class="line">                                ImagePath imagePath = new ImagePath(fileContent);</div><div class="line">                                StorageFolder folder = await StorageApplicationPermissions.FutureAccessList.GetFolderAsync(imagePath.Path);</div><div class="line">                                //筛选图片</div><div class="line">                                var queryOptions = new Windows.Storage.Search.QueryOptions();</div><div class="line">                                queryOptions.FileTypeFilter.Add(&quot;.png&quot;);</div><div class="line">                                queryOptions.FileTypeFilter.Add(&quot;.jpg&quot;);</div><div class="line">                                queryOptions.FileTypeFilter.Add(&quot;.bmp&quot;);</div><div class="line">                                var query = folder.CreateFileQueryWithOptions(queryOptions);</div><div class="line">                                var files = await query.GetFilesAsync();</div><div class="line"></div><div class="line">                                ImagePath img;</div><div class="line">                                imgList = new ObservableCollection&lt;ImagePath&gt;();</div><div class="line">                                foreach (var item in files)</div><div class="line">                                &#123;</div><div class="line">                                    IRandomAccessStream irandom = await item.OpenAsync(FileAccessMode.Read);</div><div class="line">                                   </div><div class="line">                                    //对图像源使用流源</div><div class="line">                                    BitmapImage bitmapImage = new BitmapImage();</div><div class="line">                                    bitmapImage.DecodePixelWidth = 160;</div><div class="line">                                    bitmapImage.DecodePixelHeight = 100;</div><div class="line">                                    await bitmapImage.SetSourceAsync(irandom);</div><div class="line"></div><div class="line">                                    img = new ImagePath();</div><div class="line">                                    img.Path = item.Path;</div><div class="line">                                    img.File = bitmapImage;</div><div class="line">                                    img.Storage = item;</div><div class="line">                                    imgList.Add(img);</div><div class="line">                                &#125;</div><div class="line">                                </div><div class="line">                                imageView.ItemsSource = imgList;</div><div class="line">                            &#125;</div><div class="line"></div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                catch (Exception exce)</div><div class="line">                &#123;</div><div class="line">                    await new MessageDialog(exce.ToString()).ShowAsync();</div><div class="line">                    throw exce;</div><div class="line">                &#125;</div><div class="line">            &#125;</div></pre></td></tr></table></figure></p>
<p>效果图<br><img src="/images/4-photoshow.png" alt="avatar"></p>
<h2 id="播放页面"><a href="#播放页面" class="headerlink" title="播放页面"></a>播放页面</h2><p><img src="/images/4-design3.png" alt="4-design3"></p>
<h3 id="回看标签"><a href="#回看标签" class="headerlink" title="回看标签"></a>回看标签</h3><p>这个之前已经讲过，定制过的listbox就是解决方案，只不过把水平方向换成垂直方向<br>当然，如果可以我还是想弄成等腰梯形(</p>
<h3 id="回看节目栏"><a href="#回看节目栏" class="headerlink" title="回看节目栏"></a>回看节目栏</h3><p>StackPanel就可以搞定，当然还需要定制一下ui，但是这个回看栏的翻页方式，目前我们还没有决定，是继续沿用纵向滚动的方式来加载往期节目（当然，只是滚动太low了，如果是我我也许会考虑使用异步加载来增加用户体验，用动画来掩盖加载慢的事实，用来让用户产生好流畅好惊艳的错觉，就像苹果公司经常干的。。。。。辱果了，异教徒！处死！）<br>还可以在stackpanel最后加入两个按钮，用来横向翻页。。。这个也挺简单的，stackpanel套两个水平的button，当然button的图案上要使用箭头作为图标，具体怎么加图标嘛<br><a href="https://stackoverflow.com/questions/41191758/uwp-xaml-how-to-display-a-button-with-icon-and-text-in-it" target="_blank" rel="external">https://stackoverflow.com/questions/41191758/uwp-xaml-how-to-display-a-button-with-icon-and-text-in-it</a><br>这个老哥的解释和代码我们可以看看<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">StackPanel</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Image</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">TextBlock</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这样可以让button上面有多重存在了<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Image</span> <span class="attr">Width</span>=<span class="string">"200"</span> <span class="attr">Source</span>=<span class="string">"Images/myimage.png"</span>/&gt;</span></div></pre></td></tr></table></figure></p>
<p>然后像这样设置一下icon就好了,icon的来源嘛<br>百度呀，谷歌呀，一大堆</p>
<ul>
<li><p>iconfinder<br><a href="https://www.iconfinder.com/" target="_blank" rel="external">https://www.iconfinder.com/</a></p>
</li>
<li><p>阿里的<br><a href="http://iconfont.cn/collections/detail?cid=918" target="_blank" rel="external">http://iconfont.cn/collections/detail?cid=918</a></p>
</li>
<li><p>easy icon<br><a href="https://www.easyicon.net/" target="_blank" rel="external">https://www.easyicon.net/</a></p>
</li>
</ul>
<p>p.s. 补充，这里回看节目单的效果个人认为也可以做一个ListView的列表滑动特效，不考虑加载速度etc.就是觉得这样的动态效果比较活泼。实现可以参照<a href="https://www.cnblogs.com/chifan/p/7884867.html" target="_blank" rel="external">一篇博客</a>。</p>
<h3 id="弹幕-评论区"><a href="#弹幕-评论区" class="headerlink" title="弹幕/评论区"></a>弹幕/评论区</h3><p>这种很简单的文本堆叠区域用stack panel + text block很容易实现</p>
<h3 id="弹幕-评论输入栏"><a href="#弹幕-评论输入栏" class="headerlink" title="弹幕/评论输入栏"></a>弹幕/评论输入栏</h3><p>TextBox就可以了，提交给后端，后端存到相对应的数据库</p>
<h3 id="弹幕-评论发送按钮"><a href="#弹幕-评论发送按钮" class="headerlink" title="弹幕/评论发送按钮"></a>弹幕/评论发送按钮</h3><p>一个button就可以了，设置一下onclick，上面的文本和图标已经提到过了</p>
<h3 id="视频播放器"><a href="#视频播放器" class="headerlink" title="视频播放器"></a>视频播放器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">MediaPlayerElement</span> </span></div><div class="line">    <span class="attr">Name</span>=<span class="string">"MediaPlayer"</span> <span class="attr">AutoPlay</span>=<span class="string">"False"</span></div><div class="line">    <span class="attr">Grid.Row</span>=<span class="string">"0"</span> <span class="attr">Grid.Column</span>=<span class="string">"0"</span></div><div class="line">    <span class="attr">Grid.RowSpan</span>=<span class="string">"3"</span> <span class="attr">Grid.ColumnSpan</span>=<span class="string">"3"</span></div><div class="line">    <span class="attr">Visibility</span>=<span class="string">"Collapsed"</span></div><div class="line">    <span class="attr">AreTransportControlsEnabled</span>=<span class="string">"True"</span></div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<p>之前已经写过类似的小作业了，很简单的调用一下api就好了<br>具体的代码可以看一下我的小作业<br><a href="https://github.com/HallWoodZhang/SimpleMediaPlayer_UWP" target="_blank" rel="external">https://github.com/HallWoodZhang/SimpleMediaPlayer_UWP</a><br>注释<br><a href="https://blog.csdn.net/hall_wood/article/details/79788564" target="_blank" rel="external">https://blog.csdn.net/hall_wood/article/details/79788564</a></p>
<h3 id="（扩展）弹幕显示层"><a href="#（扩展）弹幕显示层" class="headerlink" title="（扩展）弹幕显示层"></a>（扩展）弹幕显示层</h3><p>陷入江局.jpg<br>这个应该是最难的部分了。。。<br>这个问题的解决方案，应该是现有的，首先，我们应该明确一个问题，弹幕是不是可以实时更新？<br>如果可以实时更新，就像挂鱼直播那样的（呸)，或者youtube那样的评论浮现方式，都不太好实现，可能涉及到一些websocket的实现(todo: extention # 1)</p>
<ul>
<li>那么，有没有一种方法可以偷懒呢？</li>
</ul>
<p>干脆就不要实时更新弹幕了，那这就好解决了，每次打开视频，就加载某个danmaku（b站确实就叫这个)文件，然后用某种形式显示在媒体播放器上，每次有人发弹幕，就先存起来，然后刷新页面就可以看到更新的danmaku了<br>以前我用you-get爬某个大型同性交友网站视频的时候，爬到的弹幕库文件都是xml格式的，我们可以学习一个，约定好储存格式，能够适用于校园网用户规模的用户访问就行了</p>
<p>储存和发送的方法定好了，我们该如何显示弹幕，就是之后需要讨论的问题了，近年来有许多现成的实现代码，我们可以考虑参考一下他们的经验，然后自己改进一下</p>
<p><a href="https://github.com/SkylarkWorkshop/SkylarkWsp.DanmakuEngine" target="_blank" rel="external">https://github.com/SkylarkWorkshop/SkylarkWsp.DanmakuEngine</a><br>ORZ已经有大佬实现了uwp弹幕库的引擎了，惊了！<br>看看接口学习一个，看看自己是否能DIY一下<br>真的是大佬吃肉，菜鸡喝汤就能够不饿死的时代啊，感谢上帝赐我大佬</p>
<p>目前我们还没有完全确定是否要加弹幕，毕竟工作量不小，但是网上(某hub)还是有实现弹幕视频网站的实例的<br>我们可以看看别人是怎么实现弹幕图层的<br><a href="https://github.com/DaweiX/bilibili" target="_blank" rel="external">https://github.com/DaweiX/bilibili</a><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">UserControl</span></span></div><div class="line">    <span class="attr">x:Class</span>=<span class="string">"bilibili.Controls.Danmaku"</span></div><div class="line">    <span class="attr">xmlns</span>=<span class="string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></div><div class="line">    <span class="attr">xmlns:x</span>=<span class="string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></div><div class="line">    <span class="attr">xmlns:local</span>=<span class="string">"using:bilibili.Controls"</span></div><div class="line">    <span class="attr">xmlns:d</span>=<span class="string">"http://schemas.microsoft.com/expression/blend/2008"</span></div><div class="line">    <span class="attr">xmlns:mc</span>=<span class="string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></div><div class="line">    <span class="attr">mc:Ignorable</span>=<span class="string">"d"</span></div><div class="line">    <span class="attr">d:DesignHeight</span>=<span class="string">"300"</span></div><div class="line">    <span class="attr">d:DesignWidth</span>=<span class="string">"400"</span></div><div class="line">    <span class="attr">SizeChanged</span>=<span class="string">"UserControl_SizeChanged"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Grid</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"3*"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"*"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">x:Name</span>=<span class="string">"grid_0"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r1"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r2"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r3"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r4"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r5"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r6"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r7"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r8"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r9"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r10"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"space"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">x:Name</span>=<span class="string">"grid_1"</span> <span class="attr">Grid.RowSpan</span>=<span class="string">"2"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">x:Name</span>=<span class="string">"top"</span> <span class="attr">VerticalAlignment</span>=<span class="string">"Top"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">x:Name</span>=<span class="string">"bottom"</span> <span class="attr">VerticalAlignment</span>=<span class="string">"Bottom"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">UserControl</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这位仁兄把一个空间上的grid分成了10行用来显示弹幕<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div></pre></td><td class="code"><pre><div class="line">using bilibili.Helpers;</div><div class="line">using System;</div><div class="line">using System.Threading.Tasks;</div><div class="line">using Windows.UI;</div><div class="line">using Windows.UI.Core;</div><div class="line">using Windows.UI.Xaml;</div><div class="line">using Windows.UI.Xaml.Controls;</div><div class="line">using Windows.UI.Xaml.Media;</div><div class="line">using Windows.UI.Xaml.Media.Animation;</div><div class="line"></div><div class="line">//  The User Control item template is documented at http://go.microsoft.com/fwlink/?LinkId=234236</div><div class="line"></div><div class="line">namespace bilibili.Controls</div><div class="line">&#123;</div><div class="line">    public sealed partial class Danmaku : UserControl</div><div class="line">    &#123;</div><div class="line">        int row = 0;</div><div class="line">        int speed = 8;</div><div class="line">        int fontsize = 21;</div><div class="line">        bool isPause = false;</div><div class="line">        string font = &quot;默认&quot;;</div><div class="line">        public Danmaku()</div><div class="line">        &#123;</div><div class="line">            this.InitializeComponent();</div><div class="line">            speed = SettingHelper.GetValue(&quot;_speed&quot;) != null ? int.Parse(SettingHelper.GetValue(&quot;_speed&quot;).ToString()) : 8;</div><div class="line">            if (SettingHelper.GetValue(&quot;_space&quot;) != null)</div><div class="line">            &#123;</div><div class="line">                int value = int.Parse(SettingHelper.GetValue(&quot;_space&quot;).ToString());</div><div class="line">                ChangeSpace(value);</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                ChangeSpace(0);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 添加滚动弹幕</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">       /// &lt;param name=&quot;model&quot;&gt;&lt;/param&gt;</div><div class="line">        public async void AddBasic(DanmuModel model ,bool isMyDanmu)</div><div class="line">        &#123;</div><div class="line">            TextBlock txt1 = new TextBlock</div><div class="line">            &#123;</div><div class="line">                Foreground = model.DanColor,</div><div class="line">                FontFamily = new FontFamily(font)</div><div class="line">            &#125;;</div><div class="line">            TextBlock txt2 = new TextBlock</div><div class="line">            &#123;</div><div class="line">                Foreground = new SolidColorBrush(Colors.Black),</div><div class="line">                FontFamily = new FontFamily(font),</div><div class="line">                Margin = new Thickness(1),</div><div class="line">            &#125;;</div><div class="line">            Grid grid = new Grid</div><div class="line">            &#123;</div><div class="line">                HorizontalAlignment = HorizontalAlignment.Left,</div><div class="line">                VerticalAlignment = VerticalAlignment.Top,</div><div class="line">                DataContext = model,</div><div class="line">            &#125;;</div><div class="line">            if (isMyDanmu)</div><div class="line">            &#123;</div><div class="line">                grid.BorderBrush = new SolidColorBrush(Colors.HotPink);</div><div class="line">                grid.BorderThickness = new Thickness(2);</div><div class="line">            &#125;</div><div class="line">            double size = double.Parse(model.Size);</div><div class="line">            if (size == 25)</div><div class="line">            &#123;</div><div class="line">                txt2.FontSize = fontsize;</div><div class="line">                txt1.FontSize = fontsize;</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                txt2.FontSize = fontsize - 4;</div><div class="line">                txt1.FontSize = fontsize - 4;</div><div class="line">            &#125;</div><div class="line">            txt1.Text = txt2.Text = model.Message;</div><div class="line">            grid.Children.Add(txt2);</div><div class="line">            grid.Children.Add(txt1);</div><div class="line">            TranslateTransform move = new TranslateTransform();</div><div class="line">            move.X = grid_0.ActualWidth;</div><div class="line">            grid.RenderTransform = move;</div><div class="line">            grid_0.Children.Add(grid);</div><div class="line">            Grid.SetRow(grid, row);</div><div class="line">            row++;</div><div class="line">            if (row == 10)</div><div class="line">                row = 0;</div><div class="line">            grid.DataContext = model;</div><div class="line">            grid.UpdateLayout();</div><div class="line">            Storyboard sty = new Storyboard();</div><div class="line">            DoubleAnimation ani = new DoubleAnimation</div><div class="line">            &#123;</div><div class="line">                Duration = new Duration(TimeSpan.FromSeconds(speed)),</div><div class="line">                To = -(grid.ActualWidth),</div><div class="line">            &#125;;</div><div class="line">            sty.Children.Add(ani);</div><div class="line">            Storyboard.SetTarget(ani, move);</div><div class="line">            Storyboard.SetTargetProperty(ani, &quot;X&quot;);</div><div class="line">            grid.Resources.Remove(&quot;justintimeStoryboard&quot;);</div><div class="line">            grid.Resources.Add(&quot;sty&quot;, sty);</div><div class="line">            sty.Begin();</div><div class="line">            await Task.Run(async () =&gt;</div><div class="line">            &#123;</div><div class="line">                int i = 0;</div><div class="line">                while (true)</div><div class="line">                &#123;</div><div class="line">                    if (isPause)</div><div class="line">                    &#123;</div><div class="line">                        await this.Dispatcher.RunAsync(CoreDispatcherPriority.Normal, () =&gt; &#123;</div><div class="line">                            sty.Pause();</div><div class="line">                        &#125;);</div><div class="line">                    &#125;</div><div class="line">                    else</div><div class="line">                    &#123;</div><div class="line">                        if (i == speed * 2)</div><div class="line">                        &#123;</div><div class="line">                            break;</div><div class="line">                        &#125;</div><div class="line">                        i++;</div><div class="line">                        await this.Dispatcher.RunAsync(CoreDispatcherPriority.Normal, () =&gt; &#123;</div><div class="line">                            sty.Resume();</div><div class="line">                        &#125;);</div><div class="line">                    &#125;</div><div class="line">                    await Task.Delay(500);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            grid_0.Children.Remove(grid);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public void IsPauseDanmaku(bool isAction)</div><div class="line">        &#123;</div><div class="line">            isPause = isAction;</div><div class="line">        &#125;</div><div class="line">        public void Setfont(string fontname)</div><div class="line">        &#123;</div><div class="line">            font = fontname;</div><div class="line">        &#125;</div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 弹幕间距</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">        public void ChangeSpace(int value)</div><div class="line">        &#123;</div><div class="line">            double h = 0;</div><div class="line">            double actualHeight = r1.ActualHeight;</div><div class="line">            switch (value)</div><div class="line">            &#123;</div><div class="line">                case 0:</div><div class="line">                    h = 2;break;</div><div class="line">                case 1:</div><div class="line">                    h = 4;break;</div><div class="line">                case 2:</div><div class="line">                    h = 8;break;</div><div class="line">            &#125;</div><div class="line">            space.Height = new GridLength(h, GridUnitType.Pixel);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 弹幕速度</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">       /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;</div><div class="line">        public void ChangeSpeed(int value)</div><div class="line">        &#123;</div><div class="line">            speed = value;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 弹幕字号</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">       /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;</div><div class="line">        public void ChangeSize(int value)</div><div class="line">        &#123;</div><div class="line">            switch(value)</div><div class="line">            &#123;</div><div class="line">                case 0:fontsize = 14;break;</div><div class="line">                case 1: fontsize = 16; break;</div><div class="line">                case 2: fontsize = 21; break;</div><div class="line">                case 3: fontsize = 25; break;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 添加顶部和底部弹幕</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">       /// &lt;param name=&quot;model&quot;&gt;&lt;/param&gt;</div><div class="line">        public async void AddTop(DanmuModel model, bool isMyDanmu)</div><div class="line">        &#123;</div><div class="line">            TextBlock txt1 = new TextBlock</div><div class="line">            &#123;</div><div class="line">                Foreground = model.DanColor,</div><div class="line">                FontFamily = new FontFamily(font),</div><div class="line">            &#125;;</div><div class="line">            TextBlock txt2 = new TextBlock</div><div class="line">            &#123;</div><div class="line">                Foreground = new SolidColorBrush(Colors.Black),</div><div class="line">                Margin = new Thickness(1),</div><div class="line">                FontFamily = new FontFamily(font),</div><div class="line">            &#125;;</div><div class="line">            Grid grid = new Grid</div><div class="line">            &#123;</div><div class="line">                HorizontalAlignment = HorizontalAlignment.Center,</div><div class="line">                VerticalAlignment = VerticalAlignment.Top,</div><div class="line">                DataContext = model,</div><div class="line">            &#125;;</div><div class="line">            if (isMyDanmu)</div><div class="line">            &#123;</div><div class="line">                grid.BorderBrush = new SolidColorBrush(Colors.HotPink);</div><div class="line">                grid.BorderThickness = new Thickness(2);</div><div class="line">            &#125;</div><div class="line">            double size = double.Parse(model.Size);</div><div class="line">            if (size == 25)</div><div class="line">            &#123;</div><div class="line">                txt2.FontSize = fontsize;</div><div class="line">                txt1.FontSize = fontsize;</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                txt2.FontSize = fontsize - 4;</div><div class="line">                txt1.FontSize = fontsize - 4;</div><div class="line">            &#125;</div><div class="line">            txt1.Text = txt2.Text = model.Message;</div><div class="line">            grid.Children.Add(txt2);</div><div class="line">            grid.Children.Add(txt1);</div><div class="line">            grid.UpdateLayout();</div><div class="line">            if (model.Mode == &quot;5&quot;)</div><div class="line">            &#123;</div><div class="line">                top.Children.Add(grid);</div><div class="line">                await Task.Delay(5000);</div><div class="line">                if (!isPause)</div><div class="line">                &#123;</div><div class="line">                    top.Children.Remove(grid);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            else if (model.Mode == &quot;4&quot;)</div><div class="line">            &#123;</div><div class="line">                bottom.Children.Add(grid);</div><div class="line">                await Task.Delay(5000);</div><div class="line">                if (!isPause)</div><div class="line">                &#123;</div><div class="line">                    bottom.Children.Remove(grid);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 清除弹幕</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">        public void ClearDanmu()</div><div class="line">        &#123;</div><div class="line">            grid_0.Children.Clear();</div><div class="line">            top.Children.Clear();</div><div class="line">            bottom.Children.Clear();</div><div class="line">        &#125;</div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 清除顶部和底部</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">        public void ClearStaticDanmu()</div><div class="line">        &#123;</div><div class="line">            top.Children.Clear();</div><div class="line">            bottom.Children.Clear();</div><div class="line">        &#125;</div><div class="line">        public void ClearGun(bool isvisual)</div><div class="line">        &#123;</div><div class="line">            grid_0.Visibility = isvisual ? Visibility.Visible : Visibility.Collapsed;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public void ClearBottom(bool isvisual)</div><div class="line">        &#123;</div><div class="line">            bottom.Visibility = isvisual ? Visibility.Visible : Visibility.Collapsed;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public void ClearTop(bool isvisual)</div><div class="line">        &#123;</div><div class="line">            top.Visibility = isvisual ? Visibility.Visible : Visibility.Collapsed;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public class DanmuModel</div><div class="line">        &#123;</div><div class="line">            public string aid &#123; get; set; &#125;</div><div class="line">            public string Message &#123; get; set; &#125;</div><div class="line">            private decimal time;</div><div class="line">            public decimal Time</div><div class="line">            &#123;</div><div class="line">                get &#123; return time; &#125;</div><div class="line">                set &#123; time = value; &#125;</div><div class="line">            &#125;</div><div class="line">           /// &lt;summary&gt;</div><div class="line">           /// 3 滚动弹幕 4底端弹幕 5顶端弹幕 6.逆向弹幕 7精准定位 8高级弹幕</div><div class="line">           /// &lt;/summary&gt;</div><div class="line">            public string Mode &#123; get; set; &#125;</div><div class="line">            public string Size &#123; get; set;&#125;</div><div class="line">            public string Color &#123; get; set; &#125;</div><div class="line">            public SolidColorBrush color &#123; get; set; &#125;</div><div class="line">            public SolidColorBrush DanColor</div><div class="line">            &#123;</div><div class="line">                get</div><div class="line">                &#123;</div><div class="line">                    try</div><div class="line">                    &#123;</div><div class="line">                        Color = Convert.ToInt32(Color).ToString(&quot;X2&quot;);</div><div class="line">                        if (Color.StartsWith(&quot;#&quot;))</div><div class="line">                            Color = Color.Replace(&quot;#&quot;, string.Empty);</div><div class="line">                        int v = int.Parse(Color, System.Globalization.NumberStyles.HexNumber);</div><div class="line">                        SolidColorBrush solid = new SolidColorBrush(new Color()</div><div class="line">                        &#123;</div><div class="line">                            A = Convert.ToByte(255),</div><div class="line">                            R = Convert.ToByte((v &gt;&gt; 16) &amp; 255),</div><div class="line">                            G = Convert.ToByte((v &gt;&gt; 8) &amp; 255),</div><div class="line">                            B = Convert.ToByte((v &gt;&gt; 0) &amp; 255)</div><div class="line">                        &#125;);</div><div class="line">                        color = solid;</div><div class="line">                        return solid;</div><div class="line">                    &#125;</div><div class="line">                    catch (Exception)</div><div class="line">                    &#123;</div><div class="line">                        SolidColorBrush solid = new SolidColorBrush(new Color()</div><div class="line">                        &#123;</div><div class="line">                            A = 255,</div><div class="line">                            R = 255,</div><div class="line">                            G = 255,</div><div class="line">                            B = 255</div><div class="line">                        &#125;);</div><div class="line">                        color = solid;</div><div class="line">                        return solid;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        private void UserControl_SizeChanged(object sender, SizeChangedEventArgs e)</div><div class="line">        &#123;</div><div class="line">            if (ActualHeight &lt; 500)</div><div class="line">            &#123;</div><div class="line">                fontsize = 16;</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                fontsize = 21;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这个是这位仁兄的后端代码，可以说是十分规整，解决了我们如何显示弹幕在某一控件上的问题</p>
<p>那么问题来了，我们如何把这个控件和微软自带的媒体播放器接合在一起呢？<br>这需要我们进一步讨论解决方案，是采用bilibili uwp端的代码改装呢，还是使用现有的弹幕引擎，这仍然待定</p>
<p>毕竟，我们有可能压根就不实现这个功能。。。。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>只做了一点微小的工作很惭愧。队里氛围很好哇，dalao们都非常可爱。只是一讨论就会给自己不断挖坑，目前新增一坑<code>缓存视频</code>功能。<br>软件工程还是很重要的，避免疯狂堆加功能，开发模型有利于把握开发进度。还是要学习一个。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://g1ntoki0522.github.io/2018/03/31/Naive-Media-Player/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="G1NTOKI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sidebarAvatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="G1NTOKI">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/31/Naive-Media-Player/" itemprop="url">Naive Media Player</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-31T22:25:11+08:00">
                2018-03-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>简单实现了一个<a href="https://github.com/G1NTOKI0522/UWP" target="_blank" rel="external">Naive Media Player</a>两次。<br>为什么是两次呢，因为在第一次写完同步到github上时，手抖删除了对分支的更改。怒删重写后被dalao告知可以恢复呀QAQ。<br>得到惨痛教训<code>珍爱生命，远离手抖；珍爱生命，学好git</code>。重写完后觉得第二次画的背景图更interesting，就换了几张截图，故几张图细节可能有变动。<br>打开首页如下<br><img src="/images/example00.png" alt="open"><br>可点击右上角选择打开文件<br><img src="/images/example01.png" alt="openfiles"><br>播放视频效果如下<br><img src="/images/example02.png" alt="video"><br>播放音频效果如下，会直接显示背景<br><img src="/images/example03.png" alt="audio"><br>以下是在实现过程中考虑到的和遇到的问题</p>
<h2 id="播放视频、音频"><a href="#播放视频、音频" class="headerlink" title="播放视频、音频"></a>播放视频、音频</h2><p>首先想到的问题就是如何播放视频和音频。刚开始参考了XAML Controls Gallery，其中的介绍 和演示都非常简单。我尝试使用以下代码却发现并不能播放视频。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">MediaPlayerElement</span> <span class="attr">Source</span>=<span class="string">"/Assets/test.mp4"</span></span></div><div class="line">					<span class="attr">MaxWidth</span>=<span class="string">"400"</span></div><div class="line">					<span class="attr">AutoPlay</span>=<span class="string">"False"</span></div><div class="line">					<span class="attr">AreTransportControlsEnabled</span>=<span class="string">"True"</span> /&gt;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>VS会报出两个错误，一个是当前平台支持的最低版本不支持 MediaPlayerElement，二是Convert不能直接将String转换为Source。第一个问题可以通过修改 调试-属性-应用程序 中修改最低版本来解决。<br>第二个问题大概意思就是不能通过String类型的文件路径转换为Source了类型的。所以我又参考了MS官方文档中<a href="https://docs.microsoft.com/en-us/windows/uwp/audio-video-camera/play-audio-and-video-with-mediaplayer#play-a-media-file-with-mediaplayer" target="_blank" rel="external">Play a media file with MediaPlayer</a><br>与<a href="https://docs.microsoft.com/en-us/windows/uwp/audio-video-camera/play-audio-and-video-with-mediaplayer#use-mediaplayerelement-to-render-video-in-xaml" target="_blank" rel="external">Use MediaPlayerElement to render video in XAML</a><br>大概理解了如何使用这两个控件。即在XAML中放置控件MediaPlayerElement，但不在XAML中设置该控件的source之类的属性，只设置与界面有关的；在.cs文件中声明 MediaPlayer，并在.cs中设置其source，然后将XAML中的PlayerElement的播放器绑定为.cs中的MediaPlayer。<br>的确这样写更好，在XAML文件中设置布局与控件，在.cs中写逻辑。代码如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">MediaPlayerElement</span> <span class="attr">x:Name</span>=<span class="string">"mediaSimple"</span> </span></div><div class="line">			<span class="attr">AutoPlay</span>=<span class="string">"False"</span></div><div class="line">			<span class="attr">AreTransportControlsEnabled</span>=<span class="string">"True"</span></div><div class="line">			<span class="attr">IsEnabled</span>=<span class="string">"True"</span></div><div class="line">			<span class="attr">Grid.Row</span>=<span class="string">"1"</span> </div><div class="line">			/&gt;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">MediaPlayer myPlayer = new MediaPlayer();</div><div class="line">myPlayer.Source = MediaSource.CreateFromUri(new Uri(&quot;ms-appx:///Assets/test.mp4&quot;));</div><div class="line">mediaSimple.setMediaPlayer(myPlayer);</div></pre></td></tr></table></figure>
<p>然而仍然无法播放QAQ！在小方的帮助下，解决了这个问题。因为用的test.mp4文件放在了Assets文件夹下但是并没有在VS中吧该文件添加到项目里。在解决方案资源管理器中右键-添加-已有项目，选择test.mp4。</p>
<h2 id="选择文件"><a href="#选择文件" class="headerlink" title="选择文件"></a>选择文件</h2><h3 id="选择文件按钮"><a href="#选择文件按钮" class="headerlink" title="选择文件按钮"></a>选择文件按钮</h3><p>界面需要一个按钮来选择文件，这里选择了在第一行添加CommandBar，CommandBar的content来显示打开的文件名，AppButton来选择要打开的文件。参考了文档<a href="https://docs.microsoft.com/en-us/windows/uwp/design/controls-and-patterns/app-bars" target="_blank" rel="external">Command Bar</a><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">CommandBar</span> <span class="attr">DefaultLabelPosition</span>=<span class="string">"Right"</span> <span class="attr">IsOpen</span>=<span class="string">"False"</span> <span class="attr">Grid.Row</span>=<span class="string">"0"</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">CommandBar.Content</span>&gt;</span></div><div class="line">                   <span class="tag">&lt;<span class="name">TextBlock</span>  <span class="attr">Name</span>=<span class="string">"Title"</span> <span class="attr">FontSize</span>=<span class="string">"24"</span> <span class="attr">Margin</span>=<span class="string">"12,14"</span>/&gt;</span></div><div class="line">               <span class="tag">&lt;/<span class="name">CommandBar.Content</span>&gt;</span></div><div class="line">               <span class="tag">&lt;<span class="name">AppBarButton</span> <span class="attr">Icon</span>=<span class="string">"OpenFile"</span> <span class="attr">Label</span>=<span class="string">"openFile"</span> <span class="attr">Click</span>=<span class="string">"AppBarButton_Click"</span> /&gt;</span></div><div class="line">           <span class="tag">&lt;/<span class="name">CommandBar</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>但是发现有一个问题就是在CommandBar的右边总是显示[···]的More 按钮，于是又看了一下文档，发现CommandBar有<a href="https://docs.microsoft.com/en-us/uwp/api/Windows.UI.Xaml.Controls.CommandBar#Windows_UI_Xaml_Controls_CommandBar_OverflowButtonVisibility" target="_blank" rel="external">OverflowButtonVisibility</a>属性，<br>修改为隐藏即可。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;CommandBar DefaultLabelPosition=&quot;Right&quot; IsOpen=&quot;False&quot; OverflowButtonVisibility=&quot;Collapsed&quot; Grid.Row=&quot;0&quot;&gt;</div></pre></td></tr></table></figure></p>
<h3 id="选择本地文件"><a href="#选择本地文件" class="headerlink" title="选择本地文件"></a>选择本地文件</h3><p>仍然参考官方文档<a href="https://docs.microsoft.com/en-us/windows/uwp/files/quickstart-using-file-and-folder-pickers" target="_blank" rel="external">Open files and folders with a picker</a>写出如下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"> private void AppBarButton_Click(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">	var picker = new Windows.Storage.Pickers.FileOpenPicker();</div><div class="line">	picker.ViewMode = Windows.Storage.Pickers.PickerViewMode.Thumbnail;</div><div class="line">	picker.SuggestedStartLocation = Windows.Storage.Pickers.PickerLocationId.PicturesLibrary;</div><div class="line">	picker.FileTypeFilter.Add(&quot;.mp3&quot;);</div><div class="line">	picker.FileTypeFilter.Add(&quot;.mp4&quot;);</div><div class="line"></div><div class="line">	Windows.Storage.StorageFile file = await picker.PickSingleFileAsync();</div><div class="line">	if (file != null)</div><div class="line">	&#123;</div><div class="line">		// Application now has read/write access to the picked file</div><div class="line">		this.textBlock.Text = &quot;Picked photo: &quot; + file.Name;</div><div class="line">	&#125;</div><div class="line">	else</div><div class="line">	&#123;</div><div class="line">		this.textBlock.Text = &quot;Operation cancelled.&quot;;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然而多处报错，在根据VS的提示修改之后，错误更加严重了，AppBarButton_Click方法返回值类型不匹配。于是又借助搜索引擎，找到一篇<a href="https://blog.csdn.net/linwh8/article/details/70314698" target="_blank" rel="external">blog</a>参考它写出如下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">private async void add_Click(object sender, RoutedEventArgs e)</div><div class="line">       &#123;</div><div class="line">           var openPicker = new FileOpenPicker();</div><div class="line"></div><div class="line">           openPicker.SuggestedStartLocation = Windows.Storage.Pickers.PickerLocationId.VideosLibrary;</div><div class="line">           openPicker.FileTypeFilter.Add(&quot;.mp4&quot;);</div><div class="line">           openPicker.FileTypeFilter.Add(&quot;.mp3&quot;);</div><div class="line"></div><div class="line">           StorageFile file = await openPicker.PickSingleFileAsync();</div><div class="line">           if (file != null)</div><div class="line">           &#123;</div><div class="line">               var mediaSource = MediaSource.CreateFromStorageFile(file);</div><div class="line">               Title.Text = file.Name;</div><div class="line">               myPlayer.Source = mediaSource;</div><div class="line">               mediaSimple.SetMediaPlayer(myPlayer);</div><div class="line">               if (file.FileType == &quot;.mp3&quot;)</div><div class="line">               &#123;</div><div class="line">                   //Todo 播放音频时显示专辑封面旋转</div><div class="line">                   //可通过 Ellipse 实现</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line"></div><div class="line">       &#125;</div></pre></td></tr></table></figure></p>
<p>乍看没什么区别，为什么第一次就报错呢？仔细对比发现，第一次的代码在根据VS提示自动修改后会变成：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">private async System.Threading.Tasks.Task AppBarButton_ClickAsync(object sender, RoutedEventArgs e)</div></pre></td></tr></table></figure></p>
<p>将返回值类型修改成了task，这也就是为什么报错是返回值类型不匹配。这里其实之前嗨翻了一个错误，就是没有写 <code>mediaSimple.setMediaPlayer(myPlayer);</code>这句，导致打开文件之后一直啥也没有。<br>通过 <code>myPlayer.play();</code> 测试出已经正常打开文件了，这才找出是因为没有和XAML的控件绑定导致的。</p>
<h2 id="界面"><a href="#界面" class="headerlink" title="界面"></a>界面</h2><p>打开应用和播放音频时直接显示白色界面，看起来有些简陋。参考<a href="https://blog.csdn.net/linwh8/article/details/70314698" target="_blank" rel="external">blog</a><br>给Grid添加Image来简单装饰，于是打开画图板绘制了一张切合标题的背景图。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Grid.Background</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">ImageBrush</span> <span class="attr">ImageSource</span>=<span class="string">"Assets/pic.png"</span> <span class="attr">Opacity</span>=<span class="string">"0.9"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">Grid.Background</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>出现问题时要认真看报错啊，FileOpenPicker那个错误报错已经很明显了。<br>官方文档才是最全面最可靠的。<br>最后希望写代码的时候能头脑清醒，少犯智障的错误，尤其是写完了却误删代码这种，可长点心吧。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://g1ntoki0522.github.io/2018/03/26/KnowMyWeapons-Part2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="G1NTOKI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sidebarAvatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="G1NTOKI">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/26/KnowMyWeapons-Part2/" itemprop="url">KnowMyWeapons Part2</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-26T23:55:51+08:00">
                2018-03-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在快速阅读给出的文档材料并有选择的详细阅读其中部分章节后，选择5个topics来实现Bilibili App的部分功能。</p>
<h2 id="App-to-App"><a href="#App-to-App" class="headerlink" title="App-to-App"></a>App-to-App</h2><h3 id="分享视频或动态"><a href="#分享视频或动态" class="headerlink" title="分享视频或动态"></a>分享视频或动态</h3><p><img src="/images/2-0.png" alt="share"><br><img src="/images/2-1.png" alt="ShareScreenShot"><br>可使用 <a href="https://docs.microsoft.com/en-us/windows/uwp/app-to-app/share-data" target="_blank" rel="external">Share Data</a>来实现对视频或动态、图片的分享.<br>并且支持分享到B站内或者QQ、微博等其他6个App。站内分享还需使用 <a href="https://docs.microsoft.com/en-us/windows/uwp/app-to-app/receive-data" target="_blank" rel="external">Receive Data</a>在站内接收数据。</p>
<h3 id="复制评论"><a href="#复制评论" class="headerlink" title="复制评论"></a>复制评论</h3><p><img src="/images/2-2.png" alt="copy"><br>评论区长按某条评论可自动复制到剪贴板，该功能可用<a href="https://docs.microsoft.com/en-us/windows/uwp/app-to-app/copy-and-paste" target="_blank" rel="external">Copy and Paste</a>实现。<br>同时还可实现评论输入文字时粘贴剪贴板的内容。</p>
<h2 id="Audio-video-and-camera"><a href="#Audio-video-and-camera" class="headerlink" title="Audio, video, and camera"></a>Audio, video, and camera</h2><p>播放视频是B站App的主要功能，为了使用的方便B站也在此基础上添加了许多细节功能。</p>
<h3 id="播放视频、音频"><a href="#播放视频、音频" class="headerlink" title="播放视频、音频"></a>播放视频、音频</h3><p><img src="/images/2-3.png" alt="audio"><br><img src="/images/2-4.png" alt="video"><br>B站最近的更新中细分了视频区与音频区，音频和视频的播放都可以使用<a href="https://docs.microsoft.com/en-us/windows/uwp/audio-video-camera/play-audio-and-video-with-mediaplayer" target="_blank" rel="external">Play audio and video with MediaPlayer</a><br>但是，我认为无法严格实现B站的播放功能或者说是不能播放B站的视频。B站缓存在本地的视频格式是.blv,本地播放器检测不出来，且B站会对其进行分段。</p>
<h3 id="稍后播放"><a href="#稍后播放" class="headerlink" title="稍后播放"></a>稍后播放</h3><p><img src="/images/2-5.jpg" alt="playlist"><br>稍后播放即添加到播放列表，可以用<a href="https://docs.microsoft.com/en-us/windows/uwp/audio-video-camera/media-playback-with-mediasource#play-a-list-of-media-items-with-mediaplaybacklist" target="_blank" rel="external">Mediaitems,playlists,andtracks</a>实现。</p>
<h3 id="后台播放"><a href="#后台播放" class="headerlink" title="后台播放"></a>后台播放</h3><p><img src="/images/2-6.png" alt="backplay"><br>B站同样支持视频和音频的后台播放，可使用<a href="https://docs.microsoft.com/en-us/windows/uwp/audio-video-camera/background-audio" target="_blank" rel="external">Play media in the background</a>实现。</p>
<h3 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h3><p><img src="/images/2-7.jpg" alt="screencap"><br>在视频播放界面可以使用截图保存喜欢的画面，这个就是用<a href="https://docs.microsoft.com/en-us/windows/uwp/audio-video-camera/screen-capture" target="_blank" rel="external">Sreen capture</a>来完成。<br>文档中还考虑到了<a href="https://docs.microsoft.com/en-us/windows/uwp/audio-video-camera/screen-capture#react-to-capture-item-resizing-or-device-lost" target="_blank" rel="external">React to capture item resizing or device</a><br>即在截图过程中，应用调整了页面这个问题。对此 Screen Capture 的解决方案是调用 Recreate方法，并舍弃之前的所有帧。截图这个功能用起来可能只要一眨眼的功夫，然而背后实现却并不简单，需要完备的考虑各种情况。</p>
<h2 id="Devices-sensors-and-Power"><a href="#Devices-sensors-and-Power" class="headerlink" title="Devices,sensors,and Power"></a>Devices,sensors,and Power</h2><p>这一章节中有许多有趣的sensor，类似于一个sensor科普文章。介绍了许多诸如陀螺仪、罗盘、重力感应器等许多手机上常见到的感应器。</p>
<h3 id="重力旋转"><a href="#重力旋转" class="headerlink" title="重力旋转"></a>重力旋转</h3><p><img src="/images/2-8.png" alt="gravity"><br>横屏180度旋转播放界面都会自动旋转来适应，难以通过截图来体现该功能。这个功能是通过Sensor中的<a href="https://docs.microsoft.com/en-us/windows/uwp/devices-sensors/sensors#accelerometer" target="_blank" rel="external">Accelerometer</a>来做到的。<br>Sensor这一章都十分有趣，介绍了各种传感器的一些原理。比如在这个传感器中，对于旋转感应的是运动向量和重力向量之间的夹角。这也解释了为什么使用这个sensor时运动方向不能与重力方向共线。<br>回想生活中的使用场景，从站着看手机到坐下，屏幕不会旋转，而竖屏到横屏则会切换正是因为前者的运动方向是沿Z轴垂直于地面的。</p>
<h3 id="自动调节亮度"><a href="#自动调节亮度" class="headerlink" title="自动调节亮度"></a>自动调节亮度</h3><p>这个功能同样难以通过截图体现。播放界面在关灯后会自动变暗正是靠<a href="https://docs.microsoft.com/en-us/windows/uwp/devices-sensors/sensors#light-sensor" target="_blank" rel="external">Light sensor</a>实现的感知环境亮度，并依此调节屏幕亮度。</p>
<h2 id="Files-folders-and-libraries"><a href="#Files-folders-and-libraries" class="headerlink" title="Files, folders, and libraries"></a>Files, folders, and libraries</h2><h3 id="缓存、播放本地视频"><a href="#缓存、播放本地视频" class="headerlink" title="缓存、播放本地视频"></a>缓存、播放本地视频</h3><p><img src="/images/2-9.png" alt="download"><br>用户可以在使用B站播放已经缓存在本地的视频，这就需要打开本地的文件了，可以通过<a href="https://docs.microsoft.com/en-us/windows/uwp/files/quickstart-using-file-and-folder-pickers" target="_blank" rel="external">Open files and folders with a picker</a>来实现。<br>不过B站是将.blv文件直接显示在App内，而不是使用picker选择。猜测是因为格式原因，并不能使用B站播放其他视频。<br>缓存文件则可以通过<a href="https://docs.microsoft.com/en-us/windows/uwp/files/quickstart-reading-and-writing-files" target="_blank" rel="external">Create,write,and read file</a>来在本地创建文件。</p>
<h2 id="Launching-resuming-and-background-tasks"><a href="#Launching-resuming-and-background-tasks" class="headerlink" title="Launching, resuming, and background tasks"></a>Launching, resuming, and background tasks</h2><p>Background tasks包括了之前提到过的后台播放功能，主要是关于后台任务等。</p>
<h3 id="后台下载"><a href="#后台下载" class="headerlink" title="后台下载"></a>后台下载</h3><p><img src="/images/2-10.png" alt="download"><br>B站支持在后台缓存视频，后台这个可以用<a href="https://docs.microsoft.com/en-us/windows/uwp/launch-resume/#background-tasks" target="_blank" rel="external">Background tasks</a>。<br>文章中详细介绍了后台任务从创建到debug，还有处理被取消的后台任务，监控后台任务进度等。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>感受到了其系统性和完善性。如果说功能是一颗树的枝干，那么开发人员还要尽可能考虑到枝桠上的每片叶子。着实不易。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://g1ntoki0522.github.io/2018/03/19/Know-My-Weapons/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="G1NTOKI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sidebarAvatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="G1NTOKI">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/19/Know-My-Weapons/" itemprop="url">Know My Weapons</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-19T17:20:58+08:00">
                2018-03-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>简述体验所有control后，结合以前使用Qt和JAVA设计界面的经历，对其中5个control的思考。</p>
<h2 id="Acrylic"><a href="#Acrylic" class="headerlink" title="Acrylic"></a>Acrylic</h2><h3 id="效果实现"><a href="#效果实现" class="headerlink" title="效果实现"></a>效果实现</h3><p>亚克力玻璃效果被越来越多的应用到了Windows应用的设计中。这种半透明的设计使应用有了简洁大方的优雅。刚好昨天在调blog的正文背景用到了半透明（其实就是调整背景颜色的透明度），对比发现Acrylic的实现不是简单的调整Tint color 的透明度，而是加了模糊效果才做到的。</p>
<h3 id="营造景深"><a href="#营造景深" class="headerlink" title="营造景深"></a>营造景深</h3><p><img src="/images/Uvp01.gif" alt="Acrylic"><br>比起简单的透视背景，我觉得Acrylic更有趣的应用在于和ScalarAnimation的结合来营造出内容向后缩退的感觉，如上动图。这样能为扁平化设计增添景深和动感，使交互灵动活泼。</p>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p><img src="/images/acrylic.png" alt="window"><br>但是Acrylic中还有一个量即Fallback color，使窗口在非激活状态显示这个颜色，如上图XAML Control这个应用在非激活时左侧导航栏背景显示为白色。这个设计让人感觉比较鸡肋，不能体会其存在的必要性。反而会导致一些问题。比如Win自带的Calculator在最大化时会闪一下。</p>
<h2 id="Calendar"><a href="#Calendar" class="headerlink" title="Calendar"></a>Calendar</h2><p><img src="/images/CalendarDatePicker00.png" alt="calendar"></p>
<h3 id="设计缺点"><a href="#设计缺点" class="headerlink" title="设计缺点"></a>设计缺点</h3><p>年份月份的显示方式完全不能表明它其实可以被单击后修改年月，这是我随便点到才发现的功能。其次界面称得上简陋，没有我们惯用的将农历小字标注和节日节气标注。</p>
<h3 id="显示bug"><a href="#显示bug" class="headerlink" title="显示bug"></a>显示bug</h3><p>如上图显示，在选择年份时下边几个年份是不能选择的，所以做了灰色的阴影来表示，这个方法是没问题的，但是，这个控件只能使用滚轮向上逐行滚动，滚动速度是比较快的，就导致新的界面的下两行仍然有灰色阴影。猜测可能是因为追求速度，没有将每个格子重绘只是修改了显示的数字。在选择月份和日期时有同样的问题。建议将选择日期时的方式由逐行滚动变为换页，左翻一页，一页显示一个月的日期。</p>
<h2 id="Password-Box"><a href="#Password-Box" class="headerlink" title="Password Box"></a>Password Box</h2><p>密码框使用起来感觉还不错，可以在代码中设置Headler,PlaceHolderText,PasswordChar等，但有一个细节令人感觉有些不方便。如下图所示，在输入密码之后鼠标长按“眼睛”状图标即可查看输入的密码，松开后再次长按即可再次查看密码如左图所示。但是如果此时鼠标在其他任意地方单击了一次之后，这个眼睛的图标就消失了，再也不能查看已经输入的密码如下图所示。<br><img src="/images/PasswordBox01.png" alt="Password"><br>这样设计可能是为了安全考虑，但是有谁会长时间停留在输入密码的界面呢。我想大多数应用场景都是，用户手脚麻利的输入用户名和密码，然后一发自信提交，坐待登陆。当密码输入错误时才会去查看密码进行修改。偏偏此时已经不能查看，只能重新输入。<br><img src="/images/PasswordBox02.png" alt="Password-inviseble"></p>
<h2 id="RichEdit-Box"><a href="#RichEdit-Box" class="headerlink" title="RichEdit Box"></a>RichEdit Box</h2><p><img src="/images/RichEditBox.png" alt="RichEditBox"><br>这个富文本编辑器控件是麻雀虽小，五脏俱全。支持打开文件、保存文件，字体调整、文本搜索，且文本搜索对大小写不敏感。</p>
<h3 id="设计费解"><a href="#设计费解" class="headerlink" title="设计费解"></a>设计费解</h3><p>字体调整中支持粗体、斜体和，等等这个大写A下加一线竟然是修改字体颜色的？？？下划线呢？？？<br>其次，对字体选择加粗、斜体等效果后按钮毫无变化，没有被选中的显示。建议使用ToggleButton的效果直截了当的显示当前已经选中的效果如下图。<br><img src="/images/ToggleButton.png" alt="ToggleButto"></p>
<h2 id="Combo-Box"><a href="#Combo-Box" class="headerlink" title="Combo Box"></a>Combo Box</h2><p><img src="/images/ComboBox.png" alt="ComboBox"><br>为了对比Java中的ComboBox，动手在VS中实践了一下ComboBox。相比而言，这个控件的使用更简单易用。添加ComboBoxItem也只要描述清楚Item的content等就好，在JAVA中则还要考虑监听等。但是控件细节还需要完善。比如向下拉菜单中的每一项添加图片或icon图标，应用场景是绘图板中通过下拉菜单选择线型，我希望的是菜单中每一项直接是直线或虚线的图标，便于选择效果也更加直观。去年在用JAVA写画图板的大作业中实现了这个功能，走了一些弯路，因为Item直接加icon图标是不显示的，需要给每个选项添加渲染器，同时监听。而在这里，我查阅了<a href="https://docs.microsoft.com/en-us/uwp/api/Windows.UI.Xaml.Controls.ComboBox" target="_blank" rel="external">微软官方文档</a>但其中并没有提到添加图标图片之类，但在与ComboBox相似的菜单控件MenuFlyout则可以添加icons。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Windows的控件的设计风格类似于 MateriaDesign，扁平化，多留白，线条简单，配色统一。然而MicrosoftStore中的应用总是不尽人意，有些甚至是简陋。还需要相关开发者的努力哇，其实这种风格还是很好看的。<br>在学习过程中，感觉使用C#做可视化编程其实和用Qt Creator 非常相似，都可以先通过拖拽控件设计界面，然后再补充代码完善相应的event。但是使用Qt时往往是为了给用Cpp写的课设加界面，经常会出现不兼容、字符串乱码的情况。这次直接学习C#应该会好很多。但是总而言之二者都比JAVA写界面要方便的多。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://g1ntoki0522.github.io/2018/03/19/Hello-World-0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="G1NTOKI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sidebarAvatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="G1NTOKI">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/19/Hello-World-0/" itemprop="url">Hello World!</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-19T00:28:54+08:00">
                2018-03-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="/images/test-logo.jpg" alt="test"></p>
<p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=476081894&auto=0&height=66"></iframe></p>
<h2 id="Sart"><a href="#Sart" class="headerlink" title="Sart"></a>Sart</h2><p>万事开头难啊，去年暑假就申的博客一直到现在有作业催着才改好。果然<code>deadline才是第一生产力</code>。</p>
<h2 id="感受"><a href="#感受" class="headerlink" title="感受"></a>感受</h2><p>CSS真的很麻烦哇，可能因为没有系统了解过。为了达到自己想到的效果都是<a href="http://www.google.com" target="_blank" rel="external">Google</a> + 随便尝试，总是感觉容器莫名其妙的不按代码来。写的时候还要考虑各种窗体变化、兼容问题等。单是一个容器的居中效果竟然就有十多种写法，博大精深博大精深！</p>
<p>现在一些提供免费服务的网站的注册要求越来越严格了，不仅要验证手机，某牛竟然还要上传身份证照片，断然拒绝了。各种网站都在疯狂搜集个人信息，安全堪忧。</p>
<h2 id="收获"><a href="#收获" class="headerlink" title="收获"></a>收获</h2><h3 id="动手实践"><a href="#动手实践" class="headerlink" title="动手实践"></a>动手实践</h3><p>用到了老师上课讲过的margin,padding等。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">body&#123;</div><div class="line">	<span class="attr">Width</span>: fit-content;</div><div class="line">	margin-left: auto;</div><div class="line">	margin-right; auto;<span class="comment">//实现居中</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="了解深浅"><a href="#了解深浅" class="headerlink" title="了解深浅"></a>了解深浅</h3><p>一个反应快速，简洁优美的界面是如此的来之不易，需要千万次调试来对最佳设计效果精益求精。以后再吐槽界面丑的时候会小声轻轻的。<br><blockquote><p>白发三千丈，缘愁似个长。</p>
<footer><strong>李白</strong><cite>秋浦歌</cite></footer></blockquote></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本篇文章是对引用图片、音乐、高亮、标签的测试。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/sidebarAvatar.jpg"
                alt="G1NTOKI" />
            
              <p class="site-author-name" itemprop="name">G1NTOKI</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">G1NTOKI</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
