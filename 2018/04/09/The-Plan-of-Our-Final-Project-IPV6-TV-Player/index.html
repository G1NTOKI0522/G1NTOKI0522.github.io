<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="uvp," />










<meta name="description" content="小组头脑风暴了几个idea，最终经过投票，在幽灵般的第五票下决定了我们的项目主题：NEU-TV Player。项目将在我们已有的视频播放器经验上进行开发，并添加一些有趣的功能。 项目描述描述一个基于东北大学IPV6视频直播源的弹幕视频播放器。 功能观看节目涵盖中央、地方各大卫视频道，内容覆盖电影、音乐、体育、卡通应有尽有。只要连接校园网，打开本应用，在电视墙内选择你中意的频道，轻轻一点尽享缤纷精彩">
<meta name="keywords" content="uvp">
<meta property="og:type" content="article">
<meta property="og:title" content="The Plan of Our Final Project,NEU-TV Player">
<meta property="og:url" content="https://g1ntoki0522.github.io/2018/04/09/The-Plan-of-Our-Final-Project-IPV6-TV-Player/index.html">
<meta property="og:site_name" content="G1NTOKI">
<meta property="og:description" content="小组头脑风暴了几个idea，最终经过投票，在幽灵般的第五票下决定了我们的项目主题：NEU-TV Player。项目将在我们已有的视频播放器经验上进行开发，并添加一些有趣的功能。 项目描述描述一个基于东北大学IPV6视频直播源的弹幕视频播放器。 功能观看节目涵盖中央、地方各大卫视频道，内容覆盖电影、音乐、体育、卡通应有尽有。只要连接校园网，打开本应用，在电视墙内选择你中意的频道，轻轻一点尽享缤纷精彩">
<meta property="og:image" content="https://g1ntoki0522.github.io/images/4-video.png">
<meta property="og:image" content="https://g1ntoki0522.github.io/images/4-design1.png">
<meta property="og:image" content="https://g1ntoki0522.github.io/images/4-design2.png">
<meta property="og:image" content="https://g1ntoki0522.github.io/images/4-design3.png">
<meta property="og:image" content="https://g1ntoki0522.github.io/images/4-design1.png">
<meta property="og:image" content="https://g1ntoki0522.github.io/images/4-lablePage.png">
<meta property="og:image" content="https://g1ntoki0522.github.io/images/4-design2.png">
<meta property="og:image" content="https://g1ntoki0522.github.io/images/4-photoshow.png">
<meta property="og:image" content="https://g1ntoki0522.github.io/images/4-design3.png">
<meta property="og:updated_time" content="2018-04-09T12:48:16.050Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="The Plan of Our Final Project,NEU-TV Player">
<meta name="twitter:description" content="小组头脑风暴了几个idea，最终经过投票，在幽灵般的第五票下决定了我们的项目主题：NEU-TV Player。项目将在我们已有的视频播放器经验上进行开发，并添加一些有趣的功能。 项目描述描述一个基于东北大学IPV6视频直播源的弹幕视频播放器。 功能观看节目涵盖中央、地方各大卫视频道，内容覆盖电影、音乐、体育、卡通应有尽有。只要连接校园网，打开本应用，在电视墙内选择你中意的频道，轻轻一点尽享缤纷精彩">
<meta name="twitter:image" content="https://g1ntoki0522.github.io/images/4-video.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://g1ntoki0522.github.io/2018/04/09/The-Plan-of-Our-Final-Project-IPV6-TV-Player/"/>





  <title>The Plan of Our Final Project,NEU-TV Player | G1NTOKI</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">G1NTOKI</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://g1ntoki0522.github.io/2018/04/09/The-Plan-of-Our-Final-Project-IPV6-TV-Player/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="G1NTOKI">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/sidebarAvatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="G1NTOKI">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">The Plan of Our Final Project,NEU-TV Player</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-09T11:26:34+08:00">
                2018-04-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>小组头脑风暴了几个idea，最终经过投票，在幽灵般的第五票下决定了我们的项目主题：<code>NEU-TV Player</code>。项目将在我们已有的视频播放器经验上进行开发，并添加一些有趣的功能。</p>
<h1 id="项目描述"><a href="#项目描述" class="headerlink" title="项目描述"></a>项目描述</h1><h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>一个基于东北大学IPV6视频直播源的弹幕视频播放器。</p>
<h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><h3 id="观看节目"><a href="#观看节目" class="headerlink" title="观看节目"></a>观看节目</h3><p>涵盖中央、地方各大卫视频道，内容覆盖电影、音乐、体育、卡通应有尽有。只要连接校园网，打开本应用，在电视墙内选择你中意的频道，轻轻一点尽享缤纷精彩。</p>
<h3 id="频道搜索"><a href="#频道搜索" class="headerlink" title="频道搜索"></a>频道搜索</h3><p>频道太多眼花缭乱找不到想要的那一个？有想看的节目却不知道是在哪个频道？想回看某部电影却忘了之前是在什么时候播出？只要点击搜索栏，输入你想看的频道或节目名称，我们为你锁定它！</p>
<h3 id="弹幕吐槽"><a href="#弹幕吐槽" class="headerlink" title="弹幕吐槽"></a>弹幕吐槽</h3><p>快乐分享给他人会加倍快乐，那么和别人一起吐槽就更是爽翻天啦。不管是背景科普还是高能预警，通过弹幕分享你的观看体验，即使是一个人也能享受大家一起看电视的快乐！</p>
<h3 id="收藏回看"><a href="#收藏回看" class="headerlink" title="收藏回看"></a>收藏回看</h3><p>最近在追某项比赛，然而每次都要搜索体育频道很麻烦呐！不要急，收藏这个频道，让你直接追上比赛热点。<br>最近在追某部剧，然鹅某一天学业繁忙漏看了！不要方，点开节目单回看即可，最长支持7天内的视频回看哟，可以养肥后周末一口气追更。</p>
<h2 id="特色"><a href="#特色" class="headerlink" title="特色"></a>特色</h2><p><img src="/images/4-video.png" alt="4-video"></p>
<h3 id="免流量"><a href="#免流量" class="headerlink" title="免流量"></a>免流量</h3><p>只要连接校园网，不登录账号也可直接观看视频。追剧看球再也不怕流量不够了！校园网完美覆盖，走到哪里看到哪里。</p>
<h3 id="无广告"><a href="#无广告" class="headerlink" title="无广告"></a>无广告</h3><p>超清流畅无码节目源点开即看，没有烦人的弹窗广告，也没有煎熬的等待90s，毕竟你的时间，非常宝贵。</p>
<h3 id="可互动"><a href="#可互动" class="headerlink" title="可互动"></a>可互动</h3><p>通过弹幕和小伙伴分享自己的观影体验，吐槽视频的各种梗，你的弹幕可能比视频更加好玩！</p>
<h3 id="可补漏"><a href="#可补漏" class="headerlink" title="可补漏"></a>可补漏</h3><p>收藏你喜欢的频道，免去搜索的麻烦。回看一周内的视频，错过直播也不怕！</p>
<h1 id="项目设计"><a href="#项目设计" class="headerlink" title="项目设计"></a>项目设计</h1><h2 id="主界面"><a href="#主界面" class="headerlink" title="主界面"></a>主界面</h2><p><img src="/images/4-design1.png" alt="4-design1"><br>上方是标签页，通过标签页来对不同类别频道进行分类展示。标签页右侧是一个小的搜索栏。标签页下是页面主体，通过照片墙的方式来展示该类别的各个频道。点击照片即可进入对应频道观看视频。</p>
<h2 id="搜索页"><a href="#搜索页" class="headerlink" title="搜索页"></a>搜索页</h2><p><img src="/images/4-design2.png" alt="4-design2"><br>通过点击主页面的搜索栏可以转到搜索功能，动画是搜索栏向左延长横跨整个页面，上方的标签页消失，下方照片墙展示搜索结果。</p>
<h2 id="播放页"><a href="#播放页" class="headerlink" title="播放页"></a>播放页</h2><p><img src="/images/4-design3.png" alt="4-design3"><br>播放页面主要分为两部分，左侧为节目单，右侧为播放器。左侧，通过标签页展示周一到周日七天的节目单，对应日期的节目单通过垂直方向的列表显示，点击某一节目即可在播放器中回看该节目。<br>右侧，播放器类似于普通播放器，有播放/暂停按钮，进度条，音量调整，全屏按钮等。播放器下方是弹幕功能区。主要有一个文本编辑框和发送按钮构成 。文本框内输入文字，并选择不同的弹幕格式，然后点击发送按钮即可发送弹幕。</p>
<h1 id="市场调查"><a href="#市场调查" class="headerlink" title="市场调查"></a>市场调查</h1><p>小方对三位小伙伴进行了采访。先通过视频介绍我们的App，然后提问一些相关问题来帮助我们进行调整，最后将视频剪辑打码发布。<br><a href="https://www.bilibili.com/video/av21552408" target="_blank" rel="external">一个制作精良超级棒的视频</a></p>
<iframe src="//player.bilibili.com/player.html?aid=21552408&cid=35492549&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" width="600px" height="480px"> </iframe>

<p>但是分析采访内容，大家对我们的鼓励支持远远大于批评和建议，我们自己又深刻反思分析了一下，提出如下改进：</p>
<h2 id="搜索页面改进"><a href="#搜索页面改进" class="headerlink" title="搜索页面改进"></a>搜索页面改进</h2><p>搜索功能应当细化到具体节目才更有意义，但是照片墙只能展示到频道。所以对之前通过照片墙展示搜索结果的方式进行改进。点击搜索按钮后跳至新的页面，通过列表展示搜索结果。</p>
<h2 id="播放控制改进"><a href="#播放控制改进" class="headerlink" title="播放控制改进"></a>播放控制改进</h2><p>在播放器上，因为新加了弹幕功能，所以相应的也要加上关闭弹幕的功能。需要重写控制器。</p>
<h1 id="技术分析"><a href="#技术分析" class="headerlink" title="技术分析"></a>技术分析</h1><p>在确定设计之后，代锟dalao根据设计图与讨论的功能，对每个页面可能用到的技术及实现方法进行了分析。</p>
<h2 id="主页面"><a href="#主页面" class="headerlink" title="主页面"></a>主页面</h2><p><img src="/images/4-design1.png" alt="4-design1"></p>
<h3 id="标签页"><a href="#标签页" class="headerlink" title="标签页"></a>标签页</h3><p>不得不说，我最喜欢的浏览器是firefox和chrome，尤其是chrome的标签页的设计实在是太讨喜了，一点也不拖泥带水。然而，我google了半天，没有找到等腰梯形可重叠标签页的uwp现有的成熟实现方案。捉急之下我询问了老师，<br>然后找到了类似的<a href="https://stackoverflow.com/questions/3565553/listbox-items-orientation-to-horizontal" target="_blank" rel="external">解决方案</a>。<br>大体的解决方案是这样的：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ListBox</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">ListBox.ItemsPanel</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">ItemsPanelTemplate</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Orientation</span>=<span class="string">"Horizontal"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">ItemsPanelTemplate</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">ListBox.ItemsPanel</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ListBox</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>用一个stackpanel做模板？大概是这个意思，把它水平放过来<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Style</span> <span class="attr">TargetType</span>=<span class="string">"ListBox"</span>&gt;</span><span class="xml"></span></div><div class="line">    <span class="comment">&lt;!-- Rest of the style --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">"ItemsPanel"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Setter.Value</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">ItemsPanelTemplate</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Orientation</span>=<span class="string">"Horizontal"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">ItemsPanelTemplate</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Setter.Value</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">Setter</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">Style</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>增加style<br>用一个水平方向排列的ListBox来解决标签页的问题，然而，仅仅拥有标签页是不够的</p>
<p>然而，这并不能解决这个问题<br><img src="/images/4-lablePage.png" alt="lablePage"></p>
<p>没错，根本无法实现这种边的交替效果，而且也不具有chrome的那种随着标签页增加而标签缩短的效果。<br>好菜啊，从没有学过uwp的我，居然要定制UI耶QAQ。<br>那算了，实际一点，先使用edge和firefox那种扁平化的风格堆叠吧，那个稍微简单，而且我们先不考虑标签页增加而标签缩短的问题。</p>
<h3 id="搜索栏"><a href="#搜索栏" class="headerlink" title="搜索栏"></a>搜索栏</h3><p>这个功能可以使用AutoSuggestBox来实现<br>basic code:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public sealed class AutoSuggestBox : ItemsControl, IAutoSuggestBox, IAutoSuggestBox2, IAutoSuggestBox3</div></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">AutoSuggestBox</span> <span class="attr">...</span>/&gt;</span></div></pre></td></tr></table></figure>
<p>官方demo :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">// C#</div><div class="line">private void AutoSuggestBox_TextChanged(AutoSuggestBox sender, AutoSuggestBoxTextChangedEventArgs args)</div><div class="line">&#123;</div><div class="line">    // Only get results when it was a user typing, </div><div class="line">    // otherwise assume the value got filled in by TextMemberPath </div><div class="line">    // or the handler for SuggestionChosen.</div><div class="line">    if (args.Reason == AutoSuggestionBoxTextChangeReason.UserInput)</div><div class="line">    &#123;</div><div class="line">        //Set the ItemsSource to be your filtered dataset</div><div class="line">        //sender.ItemsSource = dataset;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">private void AutoSuggestBox_SuggestionChosen(AutoSuggestBox sender, AutoSuggestBoxSuggestionChosenEventArgs args)</div><div class="line">&#123;</div><div class="line">    // Set sender.Text. You can use args.SelectedItem to build your text string.</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">private void AutoSuggestBox_QuerySubmitted(AutoSuggestBox sender, AutoSuggestBoxQuerySubmittedEventArgs args)</div><div class="line">&#123;</div><div class="line">    if (args.ChosenSuggestion != null)</div><div class="line">    &#123;</div><div class="line">        // User selected an item from the suggestion list, take an action on it here.</div><div class="line">    &#125;</div><div class="line">    else</div><div class="line">    &#123;</div><div class="line">        // Use args.QueryText to determine what to do.</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这三个函数使用来分别监听前端搜索字体改变，搜索请求提交，给出建议等事件的处理函数</p>
<p>前端demo:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">AutoSuggestBox</span> <span class="attr">PlaceholderText</span>=<span class="string">"Search"</span> <span class="attr">QueryIcon</span>=<span class="string">"Find"</span> <span class="attr">Width</span>=<span class="string">"200"</span></span></div><div class="line">                <span class="attr">TextChanged</span>=<span class="string">"AutoSuggestBox_TextChanged"</span></div><div class="line">                <span class="attr">QuerySubmitted</span>=<span class="string">"AutoSuggestBox_QuerySubmitted"</span></div><div class="line">                <span class="attr">SuggestionChosen</span>=<span class="string">"AutoSuggestBox_SuggestionChosen"</span>/&gt;</div></pre></td></tr></table></figure></p>
<p>其中，PlaceholderText代表默认的占用字符串<br>Icon用的微软官方自带的图标<br>TextChanged=”AutoSuggestBox_TextChanged”<br>QuerySubmitted=”AutoSuggestBox_QuerySubmitted”<br>SuggestionChosen=”AutoSuggestBox_SuggestionChosen”<br>这三条对应后端的三个句柄(handle)，用来处理相应的事件demo(but)，原本在我们组dalao的设定中要点击搜索栏的时候搜索烂要有一个平滑延长的动画，然后标签页消失，最后过度到页面二的画面。我…..被水淹没不知所措。</p>
<p>后来了解到了一种解决方案，就是用StoryBoard做动画<br>具体的方法还没有做出来，但是还可以参考其他方案<br><a href="https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.media.animation.storyboard" target="_blank" rel="external">https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.media.animation.storyboard</a><br>basic demo<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public sealed class Storyboard : Timeline, IStoryboard</div></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Storyboard</span> <span class="attr">...</span>&gt;</span></div><div class="line">  oneOrMoreChildTimelines</div><div class="line"><span class="tag">&lt;/<span class="name">Storyboard</span>&gt;</span></div></pre></td></tr></table></figure>
<p>这种控件细究起来还是有很多拓展性的<br>先上官方demo:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">//using Windows.UI.Xaml.Media.Animation;</div><div class="line">        //using Windows.UI.Xaml.Shapes;</div><div class="line">        //using Windows.UI</div><div class="line"></div><div class="line">        private void Create_And_Run_Animation(object sender, RoutedEventArgs e)</div><div class="line">        &#123;</div><div class="line">            // Create a red rectangle that will be the target</div><div class="line">            // of the animation.</div><div class="line">            Rectangle myRectangle = new Rectangle();</div><div class="line">            myRectangle.Width = 200;</div><div class="line">            myRectangle.Height = 200;</div><div class="line">            SolidColorBrush myBrush = new SolidColorBrush(Colors.Red);</div><div class="line">            myRectangle.Fill = myBrush;</div><div class="line"></div><div class="line">            // Create the transform</div><div class="line">            TranslateTransform moveTransform = new TranslateTransform();</div><div class="line">            moveTransform.X = 0;</div><div class="line">            moveTransform.Y = 0;</div><div class="line">            myRectangle.RenderTransform = moveTransform;</div><div class="line"></div><div class="line">            // Add the rectangle to the tree.</div><div class="line">            LayoutRoot.Children.Add(myRectangle);</div><div class="line"></div><div class="line">            // Create a duration of 2 seconds.</div><div class="line">            Duration duration = new Duration(TimeSpan.FromSeconds(2));</div><div class="line">            // Create two DoubleAnimations and set their properties.</div><div class="line">            DoubleAnimation myDoubleAnimationX = new DoubleAnimation();</div><div class="line">            DoubleAnimation myDoubleAnimationY = new DoubleAnimation();</div><div class="line">            myDoubleAnimationX.Duration = duration;</div><div class="line">            myDoubleAnimationY.Duration = duration;</div><div class="line">            Storyboard justintimeStoryboard = new Storyboard();</div><div class="line">            justintimeStoryboard.Duration = duration;</div><div class="line">            justintimeStoryboard.Children.Add(myDoubleAnimationX);</div><div class="line">            justintimeStoryboard.Children.Add(myDoubleAnimationY);</div><div class="line">            Storyboard.SetTarget(myDoubleAnimationX, moveTransform);</div><div class="line">            Storyboard.SetTarget(myDoubleAnimationY, moveTransform);</div><div class="line"></div><div class="line">            // Set the X and Y properties of the Transform to be the target properties</div><div class="line">            // of the two respective DoubleAnimations.</div><div class="line">            Storyboard.SetTargetProperty(myDoubleAnimationX, &quot;X&quot;);</div><div class="line">            Storyboard.SetTargetProperty(myDoubleAnimationY, &quot;Y&quot;);</div><div class="line">            myDoubleAnimationX.To = 200;</div><div class="line">            myDoubleAnimationY.To = 200;</div><div class="line"></div><div class="line">            // Make the Storyboard a resource.</div><div class="line">            LayoutRoot.Resources.Add(&quot;justintimeStoryboard&quot;, justintimeStoryboard);</div><div class="line">            // Begin the animation.</div><div class="line">            justintimeStoryboard.Begin();</div><div class="line">        &#125;</div></pre></td></tr></table></figure></p>
<p>这个动画一共有四个部分，创建的时候也会有动画<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">x:Name</span>=<span class="string">"LayoutRoot"</span> &gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">StackPanel.Resources</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Storyboard</span> <span class="attr">x:Name</span>=<span class="string">"myStoryboard"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">DoubleAnimation</span> <span class="attr">From</span>=<span class="string">"1"</span> <span class="attr">To</span>=<span class="string">"6"</span> <span class="attr">Duration</span>=<span class="string">"00:00:6"</span> </span></div><div class="line">            <span class="attr">Storyboard.TargetName</span>=<span class="string">"rectScaleTransform"</span> </div><div class="line">            <span class="attr">Storyboard.TargetProperty</span>=<span class="string">"ScaleY"</span>&gt;</div><div class="line">                <span class="tag">&lt;<span class="name">DoubleAnimation.EasingFunction</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">BounceEase</span> <span class="attr">Bounces</span>=<span class="string">"2"</span> <span class="attr">EasingMode</span>=<span class="string">"EaseOut"</span> </span></div><div class="line">                            <span class="attr">Bounciness</span>=<span class="string">"2"</span> /&gt;</div><div class="line">                <span class="tag">&lt;/<span class="name">DoubleAnimation.EasingFunction</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">DoubleAnimation</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Storyboard</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">StackPanel.Resources</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Button that begins animation. --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Click</span>=<span class="string">"Animation_Begin"</span></span></div><div class="line">         <span class="attr">Margin</span>=<span class="string">"2"</span> <span class="attr">Content</span>=<span class="string">"Begin"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Button that pauses Animation. --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Click</span>=<span class="string">"Animation_Pause"</span></span></div><div class="line">         <span class="attr">Margin</span>=<span class="string">"2"</span> <span class="attr">Content</span>=<span class="string">"Pause"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Button that resumes Animation. --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Click</span>=<span class="string">"Animation_Resume"</span></span></div><div class="line">         <span class="attr">Margin</span>=<span class="string">"2"</span> <span class="attr">Content</span>=<span class="string">"Resume"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="comment">&lt;!-- Button that stops Animation. Stopping the animation </span></div><div class="line">         returns the ellipse to its original location. --&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">Button</span> <span class="attr">Click</span>=<span class="string">"Animation_Stop"</span></span></div><div class="line">         <span class="attr">Margin</span>=<span class="string">"2"</span> <span class="attr">Content</span>=<span class="string">"Stop"</span> /&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Rectangle</span> <span class="attr">Fill</span>=<span class="string">"Blue"</span> <span class="attr">Width</span>=<span class="string">"200"</span> <span class="attr">Height</span>=<span class="string">"30"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Rectangle.RenderTransform</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">ScaleTransform</span> <span class="attr">x:Name</span>=<span class="string">"rectScaleTransform"</span> /&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Rectangle.RenderTransform</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">Rectangle</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这个扩展性非常强，每一个事件发生都可以调用相对应的story board的产生的animation<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">private void Animation_Begin(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">    myStoryboard.Begin();</div><div class="line">&#125;</div><div class="line">private void Animation_Pause(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">    myStoryboard.Pause();</div><div class="line">&#125;</div><div class="line">private void Animation_Resume(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">    myStoryboard.Resume();</div><div class="line">&#125;</div><div class="line">private void Animation_Stop(object sender, RoutedEventArgs e)</div><div class="line">&#123;</div><div class="line">    myStoryboard.Stop();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当我们设定好动画之后，就可以体验到那种顺滑的感觉</p>
<h2 id="搜索页面"><a href="#搜索页面" class="headerlink" title="搜索页面"></a>搜索页面</h2><p><img src="/images/4-design2.png" alt="4-design2"></p>
<h3 id="搜索栏-1"><a href="#搜索栏-1" class="headerlink" title="搜索栏"></a>搜索栏</h3><p>这个我之前已经提到过了，这里不再细讲</p>
<h3 id="节目缩略图"><a href="#节目缩略图" class="headerlink" title="节目缩略图"></a>节目缩略图</h3><p>这个图片来源主要来自于后端提供，简单来说，其实就是<a href="https://www.cnblogs.com/bestckk/p/6035139.html" target="_blank" rel="external">Image</a>这个博客就有一个很好的demo来展示如何显示出一个图片墙。<br>不过他是用的某种选择文件夹的方式，我们改改也就可以用了，用服务器的某个文件夹这样？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">StorageFile fileLocal = await StorageFile.GetFileFromApplicationUriAsync(new Uri(&quot;ms-appdata:///local/account/&quot; + ImageHelper.folderStr + &quot;.json&quot;));</div><div class="line">            if (fileLocal != null)</div><div class="line">            &#123;</div><div class="line">                try</div><div class="line">                &#123;</div><div class="line">                    //读取本地文件内容，并且反序列化</div><div class="line">                    using (IRandomAccessStream readStream = await fileLocal.OpenAsync(FileAccessMode.Read))</div><div class="line">                    &#123;</div><div class="line">                        using (DataReader dataReader = new DataReader(readStream))</div><div class="line">                        &#123;</div><div class="line">                            UInt64 size = readStream.Size;</div><div class="line">                            if (size &lt;= UInt32.MaxValue)</div><div class="line">                            &#123;</div><div class="line">                                await dataReader.LoadAsync(sizeof(Int32));</div><div class="line">                                Int32 stringSize = dataReader.ReadInt32();</div><div class="line">                                await dataReader.LoadAsync((UInt32)stringSize);</div><div class="line">                                string fileContent = dataReader.ReadString((uint)stringSize);</div><div class="line">                                ImagePath imagePath = new ImagePath(fileContent);</div><div class="line">                                StorageFolder folder = await StorageApplicationPermissions.FutureAccessList.GetFolderAsync(imagePath.Path);</div><div class="line">                                //筛选图片</div><div class="line">                                var queryOptions = new Windows.Storage.Search.QueryOptions();</div><div class="line">                                queryOptions.FileTypeFilter.Add(&quot;.png&quot;);</div><div class="line">                                queryOptions.FileTypeFilter.Add(&quot;.jpg&quot;);</div><div class="line">                                queryOptions.FileTypeFilter.Add(&quot;.bmp&quot;);</div><div class="line">                                var query = folder.CreateFileQueryWithOptions(queryOptions);</div><div class="line">                                var files = await query.GetFilesAsync();</div><div class="line"></div><div class="line">                                ImagePath img;</div><div class="line">                                imgList = new ObservableCollection&lt;ImagePath&gt;();</div><div class="line">                                foreach (var item in files)</div><div class="line">                                &#123;</div><div class="line">                                    IRandomAccessStream irandom = await item.OpenAsync(FileAccessMode.Read);</div><div class="line">                                   </div><div class="line">                                    //对图像源使用流源</div><div class="line">                                    BitmapImage bitmapImage = new BitmapImage();</div><div class="line">                                    bitmapImage.DecodePixelWidth = 160;</div><div class="line">                                    bitmapImage.DecodePixelHeight = 100;</div><div class="line">                                    await bitmapImage.SetSourceAsync(irandom);</div><div class="line"></div><div class="line">                                    img = new ImagePath();</div><div class="line">                                    img.Path = item.Path;</div><div class="line">                                    img.File = bitmapImage;</div><div class="line">                                    img.Storage = item;</div><div class="line">                                    imgList.Add(img);</div><div class="line">                                &#125;</div><div class="line">                                </div><div class="line">                                imageView.ItemsSource = imgList;</div><div class="line">                            &#125;</div><div class="line"></div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                catch (Exception exce)</div><div class="line">                &#123;</div><div class="line">                    await new MessageDialog(exce.ToString()).ShowAsync();</div><div class="line">                    throw exce;</div><div class="line">                &#125;</div><div class="line">            &#125;</div></pre></td></tr></table></figure></p>
<p>效果图<br><img src="/images/4-photoshow.png" alt="avatar"></p>
<h2 id="播放页面"><a href="#播放页面" class="headerlink" title="播放页面"></a>播放页面</h2><p><img src="/images/4-design3.png" alt="4-design3"></p>
<h3 id="回看标签"><a href="#回看标签" class="headerlink" title="回看标签"></a>回看标签</h3><p>这个之前已经讲过，定制过的listbox就是解决方案，只不过把水平方向换成垂直方向<br>当然，如果可以我还是想弄成等腰梯形(</p>
<h3 id="回看节目栏"><a href="#回看节目栏" class="headerlink" title="回看节目栏"></a>回看节目栏</h3><p>StackPanel就可以搞定，当然还需要定制一下ui，但是这个回看栏的翻页方式，目前我们还没有决定，是继续沿用纵向滚动的方式来加载往期节目（当然，只是滚动太low了，如果是我我也许会考虑使用异步加载来增加用户体验，用动画来掩盖加载慢的事实，用来让用户产生好流畅好惊艳的错觉，就像苹果公司经常干的。。。。。辱果了，异教徒！处死！）<br>还可以在stackpanel最后加入两个按钮，用来横向翻页。。。这个也挺简单的，stackpanel套两个水平的button，当然button的图案上要使用箭头作为图标，具体怎么加图标嘛<br><a href="https://stackoverflow.com/questions/41191758/uwp-xaml-how-to-display-a-button-with-icon-and-text-in-it" target="_blank" rel="external">https://stackoverflow.com/questions/41191758/uwp-xaml-how-to-display-a-button-with-icon-and-text-in-it</a><br>这个老哥的解释和代码我们可以看看<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">StackPanel</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Image</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">TextBlock</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">Button</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这样可以让button上面有多重存在了<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Image</span> <span class="attr">Width</span>=<span class="string">"200"</span> <span class="attr">Source</span>=<span class="string">"Images/myimage.png"</span>/&gt;</span></div></pre></td></tr></table></figure></p>
<p>然后像这样设置一下icon就好了,icon的来源嘛<br>百度呀，谷歌呀，一大堆</p>
<ul>
<li><p>iconfinder<br><a href="https://www.iconfinder.com/" target="_blank" rel="external">https://www.iconfinder.com/</a></p>
</li>
<li><p>阿里的<br><a href="http://iconfont.cn/collections/detail?cid=918" target="_blank" rel="external">http://iconfont.cn/collections/detail?cid=918</a></p>
</li>
<li><p>easy icon<br><a href="https://www.easyicon.net/" target="_blank" rel="external">https://www.easyicon.net/</a></p>
</li>
</ul>
<p>p.s. 补充，这里回看节目单的效果个人认为也可以做一个ListView的列表滑动特效，不考虑加载速度etc.就是觉得这样的动态效果比较活泼。实现可以参照<a href="https://www.cnblogs.com/chifan/p/7884867.html" target="_blank" rel="external">一篇博客</a>。</p>
<h3 id="弹幕-评论区"><a href="#弹幕-评论区" class="headerlink" title="弹幕/评论区"></a>弹幕/评论区</h3><p>这种很简单的文本堆叠区域用stack panel + text block很容易实现</p>
<h3 id="弹幕-评论输入栏"><a href="#弹幕-评论输入栏" class="headerlink" title="弹幕/评论输入栏"></a>弹幕/评论输入栏</h3><p>TextBox就可以了，提交给后端，后端存到相对应的数据库</p>
<h3 id="弹幕-评论发送按钮"><a href="#弹幕-评论发送按钮" class="headerlink" title="弹幕/评论发送按钮"></a>弹幕/评论发送按钮</h3><p>一个button就可以了，设置一下onclick，上面的文本和图标已经提到过了</p>
<h3 id="视频播放器"><a href="#视频播放器" class="headerlink" title="视频播放器"></a>视频播放器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">MediaPlayerElement</span> </span></div><div class="line">    <span class="attr">Name</span>=<span class="string">"MediaPlayer"</span> <span class="attr">AutoPlay</span>=<span class="string">"False"</span></div><div class="line">    <span class="attr">Grid.Row</span>=<span class="string">"0"</span> <span class="attr">Grid.Column</span>=<span class="string">"0"</span></div><div class="line">    <span class="attr">Grid.RowSpan</span>=<span class="string">"3"</span> <span class="attr">Grid.ColumnSpan</span>=<span class="string">"3"</span></div><div class="line">    <span class="attr">Visibility</span>=<span class="string">"Collapsed"</span></div><div class="line">    <span class="attr">AreTransportControlsEnabled</span>=<span class="string">"True"</span></div><div class="line">/&gt;</div></pre></td></tr></table></figure>
<p>之前已经写过类似的小作业了，很简单的调用一下api就好了<br>具体的代码可以看一下我的小作业<br><a href="https://github.com/HallWoodZhang/SimpleMediaPlayer_UWP" target="_blank" rel="external">https://github.com/HallWoodZhang/SimpleMediaPlayer_UWP</a><br>注释<br><a href="https://blog.csdn.net/hall_wood/article/details/79788564" target="_blank" rel="external">https://blog.csdn.net/hall_wood/article/details/79788564</a></p>
<h3 id="（扩展）弹幕显示层"><a href="#（扩展）弹幕显示层" class="headerlink" title="（扩展）弹幕显示层"></a>（扩展）弹幕显示层</h3><p>陷入江局.jpg<br>这个应该是最难的部分了。。。<br>这个问题的解决方案，应该是现有的，首先，我们应该明确一个问题，弹幕是不是可以实时更新？<br>如果可以实时更新，就像挂鱼直播那样的（呸)，或者youtube那样的评论浮现方式，都不太好实现，可能涉及到一些websocket的实现(todo: extention # 1)</p>
<ul>
<li>那么，有没有一种方法可以偷懒呢？</li>
</ul>
<p>干脆就不要实时更新弹幕了，那这就好解决了，每次打开视频，就加载某个danmaku（b站确实就叫这个)文件，然后用某种形式显示在媒体播放器上，每次有人发弹幕，就先存起来，然后刷新页面就可以看到更新的danmaku了<br>以前我用you-get爬某个大型同性交友网站视频的时候，爬到的弹幕库文件都是xml格式的，我们可以学习一个，约定好储存格式，能够适用于校园网用户规模的用户访问就行了</p>
<p>储存和发送的方法定好了，我们该如何显示弹幕，就是之后需要讨论的问题了，近年来有许多现成的实现代码，我们可以考虑参考一下他们的经验，然后自己改进一下</p>
<p><a href="https://github.com/SkylarkWorkshop/SkylarkWsp.DanmakuEngine" target="_blank" rel="external">https://github.com/SkylarkWorkshop/SkylarkWsp.DanmakuEngine</a><br>ORZ已经有大佬实现了uwp弹幕库的引擎了，惊了！<br>看看接口学习一个，看看自己是否能DIY一下<br>真的是大佬吃肉，菜鸡喝汤就能够不饿死的时代啊，感谢上帝赐我大佬</p>
<p>目前我们还没有完全确定是否要加弹幕，毕竟工作量不小，但是网上(某hub)还是有实现弹幕视频网站的实例的<br>我们可以看看别人是怎么实现弹幕图层的<br><a href="https://github.com/DaweiX/bilibili" target="_blank" rel="external">https://github.com/DaweiX/bilibili</a><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">UserControl</span></span></div><div class="line">    <span class="attr">x:Class</span>=<span class="string">"bilibili.Controls.Danmaku"</span></div><div class="line">    <span class="attr">xmlns</span>=<span class="string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></div><div class="line">    <span class="attr">xmlns:x</span>=<span class="string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></div><div class="line">    <span class="attr">xmlns:local</span>=<span class="string">"using:bilibili.Controls"</span></div><div class="line">    <span class="attr">xmlns:d</span>=<span class="string">"http://schemas.microsoft.com/expression/blend/2008"</span></div><div class="line">    <span class="attr">xmlns:mc</span>=<span class="string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></div><div class="line">    <span class="attr">mc:Ignorable</span>=<span class="string">"d"</span></div><div class="line">    <span class="attr">d:DesignHeight</span>=<span class="string">"300"</span></div><div class="line">    <span class="attr">d:DesignWidth</span>=<span class="string">"400"</span></div><div class="line">    <span class="attr">SizeChanged</span>=<span class="string">"UserControl_SizeChanged"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">Grid</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"3*"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">"*"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">x:Name</span>=<span class="string">"grid_0"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r1"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r2"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r3"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r4"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r5"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r6"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r7"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r8"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r9"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"r10"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">x:Name</span>=<span class="string">"space"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">Grid.RowDefinitions</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">Grid</span> <span class="attr">x:Name</span>=<span class="string">"grid_1"</span> <span class="attr">Grid.RowSpan</span>=<span class="string">"2"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">x:Name</span>=<span class="string">"top"</span> <span class="attr">VerticalAlignment</span>=<span class="string">"Top"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">x:Name</span>=<span class="string">"bottom"</span> <span class="attr">VerticalAlignment</span>=<span class="string">"Bottom"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">UserControl</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这位仁兄把一个空间上的grid分成了10行用来显示弹幕<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div></pre></td><td class="code"><pre><div class="line">using bilibili.Helpers;</div><div class="line">using System;</div><div class="line">using System.Threading.Tasks;</div><div class="line">using Windows.UI;</div><div class="line">using Windows.UI.Core;</div><div class="line">using Windows.UI.Xaml;</div><div class="line">using Windows.UI.Xaml.Controls;</div><div class="line">using Windows.UI.Xaml.Media;</div><div class="line">using Windows.UI.Xaml.Media.Animation;</div><div class="line"></div><div class="line">//  The User Control item template is documented at http://go.microsoft.com/fwlink/?LinkId=234236</div><div class="line"></div><div class="line">namespace bilibili.Controls</div><div class="line">&#123;</div><div class="line">    public sealed partial class Danmaku : UserControl</div><div class="line">    &#123;</div><div class="line">        int row = 0;</div><div class="line">        int speed = 8;</div><div class="line">        int fontsize = 21;</div><div class="line">        bool isPause = false;</div><div class="line">        string font = &quot;默认&quot;;</div><div class="line">        public Danmaku()</div><div class="line">        &#123;</div><div class="line">            this.InitializeComponent();</div><div class="line">            speed = SettingHelper.GetValue(&quot;_speed&quot;) != null ? int.Parse(SettingHelper.GetValue(&quot;_speed&quot;).ToString()) : 8;</div><div class="line">            if (SettingHelper.GetValue(&quot;_space&quot;) != null)</div><div class="line">            &#123;</div><div class="line">                int value = int.Parse(SettingHelper.GetValue(&quot;_space&quot;).ToString());</div><div class="line">                ChangeSpace(value);</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                ChangeSpace(0);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 添加滚动弹幕</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">       /// &lt;param name=&quot;model&quot;&gt;&lt;/param&gt;</div><div class="line">        public async void AddBasic(DanmuModel model ,bool isMyDanmu)</div><div class="line">        &#123;</div><div class="line">            TextBlock txt1 = new TextBlock</div><div class="line">            &#123;</div><div class="line">                Foreground = model.DanColor,</div><div class="line">                FontFamily = new FontFamily(font)</div><div class="line">            &#125;;</div><div class="line">            TextBlock txt2 = new TextBlock</div><div class="line">            &#123;</div><div class="line">                Foreground = new SolidColorBrush(Colors.Black),</div><div class="line">                FontFamily = new FontFamily(font),</div><div class="line">                Margin = new Thickness(1),</div><div class="line">            &#125;;</div><div class="line">            Grid grid = new Grid</div><div class="line">            &#123;</div><div class="line">                HorizontalAlignment = HorizontalAlignment.Left,</div><div class="line">                VerticalAlignment = VerticalAlignment.Top,</div><div class="line">                DataContext = model,</div><div class="line">            &#125;;</div><div class="line">            if (isMyDanmu)</div><div class="line">            &#123;</div><div class="line">                grid.BorderBrush = new SolidColorBrush(Colors.HotPink);</div><div class="line">                grid.BorderThickness = new Thickness(2);</div><div class="line">            &#125;</div><div class="line">            double size = double.Parse(model.Size);</div><div class="line">            if (size == 25)</div><div class="line">            &#123;</div><div class="line">                txt2.FontSize = fontsize;</div><div class="line">                txt1.FontSize = fontsize;</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                txt2.FontSize = fontsize - 4;</div><div class="line">                txt1.FontSize = fontsize - 4;</div><div class="line">            &#125;</div><div class="line">            txt1.Text = txt2.Text = model.Message;</div><div class="line">            grid.Children.Add(txt2);</div><div class="line">            grid.Children.Add(txt1);</div><div class="line">            TranslateTransform move = new TranslateTransform();</div><div class="line">            move.X = grid_0.ActualWidth;</div><div class="line">            grid.RenderTransform = move;</div><div class="line">            grid_0.Children.Add(grid);</div><div class="line">            Grid.SetRow(grid, row);</div><div class="line">            row++;</div><div class="line">            if (row == 10)</div><div class="line">                row = 0;</div><div class="line">            grid.DataContext = model;</div><div class="line">            grid.UpdateLayout();</div><div class="line">            Storyboard sty = new Storyboard();</div><div class="line">            DoubleAnimation ani = new DoubleAnimation</div><div class="line">            &#123;</div><div class="line">                Duration = new Duration(TimeSpan.FromSeconds(speed)),</div><div class="line">                To = -(grid.ActualWidth),</div><div class="line">            &#125;;</div><div class="line">            sty.Children.Add(ani);</div><div class="line">            Storyboard.SetTarget(ani, move);</div><div class="line">            Storyboard.SetTargetProperty(ani, &quot;X&quot;);</div><div class="line">            grid.Resources.Remove(&quot;justintimeStoryboard&quot;);</div><div class="line">            grid.Resources.Add(&quot;sty&quot;, sty);</div><div class="line">            sty.Begin();</div><div class="line">            await Task.Run(async () =&gt;</div><div class="line">            &#123;</div><div class="line">                int i = 0;</div><div class="line">                while (true)</div><div class="line">                &#123;</div><div class="line">                    if (isPause)</div><div class="line">                    &#123;</div><div class="line">                        await this.Dispatcher.RunAsync(CoreDispatcherPriority.Normal, () =&gt; &#123;</div><div class="line">                            sty.Pause();</div><div class="line">                        &#125;);</div><div class="line">                    &#125;</div><div class="line">                    else</div><div class="line">                    &#123;</div><div class="line">                        if (i == speed * 2)</div><div class="line">                        &#123;</div><div class="line">                            break;</div><div class="line">                        &#125;</div><div class="line">                        i++;</div><div class="line">                        await this.Dispatcher.RunAsync(CoreDispatcherPriority.Normal, () =&gt; &#123;</div><div class="line">                            sty.Resume();</div><div class="line">                        &#125;);</div><div class="line">                    &#125;</div><div class="line">                    await Task.Delay(500);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            grid_0.Children.Remove(grid);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public void IsPauseDanmaku(bool isAction)</div><div class="line">        &#123;</div><div class="line">            isPause = isAction;</div><div class="line">        &#125;</div><div class="line">        public void Setfont(string fontname)</div><div class="line">        &#123;</div><div class="line">            font = fontname;</div><div class="line">        &#125;</div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 弹幕间距</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">        public void ChangeSpace(int value)</div><div class="line">        &#123;</div><div class="line">            double h = 0;</div><div class="line">            double actualHeight = r1.ActualHeight;</div><div class="line">            switch (value)</div><div class="line">            &#123;</div><div class="line">                case 0:</div><div class="line">                    h = 2;break;</div><div class="line">                case 1:</div><div class="line">                    h = 4;break;</div><div class="line">                case 2:</div><div class="line">                    h = 8;break;</div><div class="line">            &#125;</div><div class="line">            space.Height = new GridLength(h, GridUnitType.Pixel);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 弹幕速度</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">       /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;</div><div class="line">        public void ChangeSpeed(int value)</div><div class="line">        &#123;</div><div class="line">            speed = value;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 弹幕字号</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">       /// &lt;param name=&quot;value&quot;&gt;&lt;/param&gt;</div><div class="line">        public void ChangeSize(int value)</div><div class="line">        &#123;</div><div class="line">            switch(value)</div><div class="line">            &#123;</div><div class="line">                case 0:fontsize = 14;break;</div><div class="line">                case 1: fontsize = 16; break;</div><div class="line">                case 2: fontsize = 21; break;</div><div class="line">                case 3: fontsize = 25; break;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 添加顶部和底部弹幕</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">       /// &lt;param name=&quot;model&quot;&gt;&lt;/param&gt;</div><div class="line">        public async void AddTop(DanmuModel model, bool isMyDanmu)</div><div class="line">        &#123;</div><div class="line">            TextBlock txt1 = new TextBlock</div><div class="line">            &#123;</div><div class="line">                Foreground = model.DanColor,</div><div class="line">                FontFamily = new FontFamily(font),</div><div class="line">            &#125;;</div><div class="line">            TextBlock txt2 = new TextBlock</div><div class="line">            &#123;</div><div class="line">                Foreground = new SolidColorBrush(Colors.Black),</div><div class="line">                Margin = new Thickness(1),</div><div class="line">                FontFamily = new FontFamily(font),</div><div class="line">            &#125;;</div><div class="line">            Grid grid = new Grid</div><div class="line">            &#123;</div><div class="line">                HorizontalAlignment = HorizontalAlignment.Center,</div><div class="line">                VerticalAlignment = VerticalAlignment.Top,</div><div class="line">                DataContext = model,</div><div class="line">            &#125;;</div><div class="line">            if (isMyDanmu)</div><div class="line">            &#123;</div><div class="line">                grid.BorderBrush = new SolidColorBrush(Colors.HotPink);</div><div class="line">                grid.BorderThickness = new Thickness(2);</div><div class="line">            &#125;</div><div class="line">            double size = double.Parse(model.Size);</div><div class="line">            if (size == 25)</div><div class="line">            &#123;</div><div class="line">                txt2.FontSize = fontsize;</div><div class="line">                txt1.FontSize = fontsize;</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                txt2.FontSize = fontsize - 4;</div><div class="line">                txt1.FontSize = fontsize - 4;</div><div class="line">            &#125;</div><div class="line">            txt1.Text = txt2.Text = model.Message;</div><div class="line">            grid.Children.Add(txt2);</div><div class="line">            grid.Children.Add(txt1);</div><div class="line">            grid.UpdateLayout();</div><div class="line">            if (model.Mode == &quot;5&quot;)</div><div class="line">            &#123;</div><div class="line">                top.Children.Add(grid);</div><div class="line">                await Task.Delay(5000);</div><div class="line">                if (!isPause)</div><div class="line">                &#123;</div><div class="line">                    top.Children.Remove(grid);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            else if (model.Mode == &quot;4&quot;)</div><div class="line">            &#123;</div><div class="line">                bottom.Children.Add(grid);</div><div class="line">                await Task.Delay(5000);</div><div class="line">                if (!isPause)</div><div class="line">                &#123;</div><div class="line">                    bottom.Children.Remove(grid);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 清除弹幕</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">        public void ClearDanmu()</div><div class="line">        &#123;</div><div class="line">            grid_0.Children.Clear();</div><div class="line">            top.Children.Clear();</div><div class="line">            bottom.Children.Clear();</div><div class="line">        &#125;</div><div class="line">       /// &lt;summary&gt;</div><div class="line">       /// 清除顶部和底部</div><div class="line">       /// &lt;/summary&gt;</div><div class="line">        public void ClearStaticDanmu()</div><div class="line">        &#123;</div><div class="line">            top.Children.Clear();</div><div class="line">            bottom.Children.Clear();</div><div class="line">        &#125;</div><div class="line">        public void ClearGun(bool isvisual)</div><div class="line">        &#123;</div><div class="line">            grid_0.Visibility = isvisual ? Visibility.Visible : Visibility.Collapsed;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public void ClearBottom(bool isvisual)</div><div class="line">        &#123;</div><div class="line">            bottom.Visibility = isvisual ? Visibility.Visible : Visibility.Collapsed;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public void ClearTop(bool isvisual)</div><div class="line">        &#123;</div><div class="line">            top.Visibility = isvisual ? Visibility.Visible : Visibility.Collapsed;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public class DanmuModel</div><div class="line">        &#123;</div><div class="line">            public string aid &#123; get; set; &#125;</div><div class="line">            public string Message &#123; get; set; &#125;</div><div class="line">            private decimal time;</div><div class="line">            public decimal Time</div><div class="line">            &#123;</div><div class="line">                get &#123; return time; &#125;</div><div class="line">                set &#123; time = value; &#125;</div><div class="line">            &#125;</div><div class="line">           /// &lt;summary&gt;</div><div class="line">           /// 3 滚动弹幕 4底端弹幕 5顶端弹幕 6.逆向弹幕 7精准定位 8高级弹幕</div><div class="line">           /// &lt;/summary&gt;</div><div class="line">            public string Mode &#123; get; set; &#125;</div><div class="line">            public string Size &#123; get; set;&#125;</div><div class="line">            public string Color &#123; get; set; &#125;</div><div class="line">            public SolidColorBrush color &#123; get; set; &#125;</div><div class="line">            public SolidColorBrush DanColor</div><div class="line">            &#123;</div><div class="line">                get</div><div class="line">                &#123;</div><div class="line">                    try</div><div class="line">                    &#123;</div><div class="line">                        Color = Convert.ToInt32(Color).ToString(&quot;X2&quot;);</div><div class="line">                        if (Color.StartsWith(&quot;#&quot;))</div><div class="line">                            Color = Color.Replace(&quot;#&quot;, string.Empty);</div><div class="line">                        int v = int.Parse(Color, System.Globalization.NumberStyles.HexNumber);</div><div class="line">                        SolidColorBrush solid = new SolidColorBrush(new Color()</div><div class="line">                        &#123;</div><div class="line">                            A = Convert.ToByte(255),</div><div class="line">                            R = Convert.ToByte((v &gt;&gt; 16) &amp; 255),</div><div class="line">                            G = Convert.ToByte((v &gt;&gt; 8) &amp; 255),</div><div class="line">                            B = Convert.ToByte((v &gt;&gt; 0) &amp; 255)</div><div class="line">                        &#125;);</div><div class="line">                        color = solid;</div><div class="line">                        return solid;</div><div class="line">                    &#125;</div><div class="line">                    catch (Exception)</div><div class="line">                    &#123;</div><div class="line">                        SolidColorBrush solid = new SolidColorBrush(new Color()</div><div class="line">                        &#123;</div><div class="line">                            A = 255,</div><div class="line">                            R = 255,</div><div class="line">                            G = 255,</div><div class="line">                            B = 255</div><div class="line">                        &#125;);</div><div class="line">                        color = solid;</div><div class="line">                        return solid;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        private void UserControl_SizeChanged(object sender, SizeChangedEventArgs e)</div><div class="line">        &#123;</div><div class="line">            if (ActualHeight &lt; 500)</div><div class="line">            &#123;</div><div class="line">                fontsize = 16;</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                fontsize = 21;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这个是这位仁兄的后端代码，可以说是十分规整，解决了我们如何显示弹幕在某一控件上的问题</p>
<p>那么问题来了，我们如何把这个控件和微软自带的媒体播放器接合在一起呢？<br>这需要我们进一步讨论解决方案，是采用bilibili uwp端的代码改装呢，还是使用现有的弹幕引擎，这仍然待定</p>
<p>毕竟，我们有可能压根就不实现这个功能。。。。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>只做了一点微小的工作很惭愧。队里氛围很好哇，dalao们都非常可爱。只是一讨论就会给自己不断挖坑，目前新增一坑<code>缓存视频</code>功能。<br>软件工程还是很重要的，避免疯狂堆加功能，开发模型有利于把握开发进度。还是要学习一个。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/uvp/" rel="tag"># uvp</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/03/31/Naive-Media-Player/" rel="next" title="Naive Media Player">
                <i class="fa fa-chevron-left"></i> Naive Media Player
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zNDk3MC8xMTUwNw=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/sidebarAvatar.jpg"
                alt="G1NTOKI" />
            
              <p class="site-author-name" itemprop="name">G1NTOKI</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#项目描述"><span class="nav-number">1.</span> <span class="nav-text">项目描述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#描述"><span class="nav-number">1.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#功能"><span class="nav-number">1.2.</span> <span class="nav-text">功能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#观看节目"><span class="nav-number">1.2.1.</span> <span class="nav-text">观看节目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#频道搜索"><span class="nav-number">1.2.2.</span> <span class="nav-text">频道搜索</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#弹幕吐槽"><span class="nav-number">1.2.3.</span> <span class="nav-text">弹幕吐槽</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#收藏回看"><span class="nav-number">1.2.4.</span> <span class="nav-text">收藏回看</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#特色"><span class="nav-number">1.3.</span> <span class="nav-text">特色</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#免流量"><span class="nav-number">1.3.1.</span> <span class="nav-text">免流量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#无广告"><span class="nav-number">1.3.2.</span> <span class="nav-text">无广告</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#可互动"><span class="nav-number">1.3.3.</span> <span class="nav-text">可互动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#可补漏"><span class="nav-number">1.3.4.</span> <span class="nav-text">可补漏</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#项目设计"><span class="nav-number">2.</span> <span class="nav-text">项目设计</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#主界面"><span class="nav-number">2.1.</span> <span class="nav-text">主界面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#搜索页"><span class="nav-number">2.2.</span> <span class="nav-text">搜索页</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#播放页"><span class="nav-number">2.3.</span> <span class="nav-text">播放页</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#市场调查"><span class="nav-number">3.</span> <span class="nav-text">市场调查</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#搜索页面改进"><span class="nav-number">3.1.</span> <span class="nav-text">搜索页面改进</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#播放控制改进"><span class="nav-number">3.2.</span> <span class="nav-text">播放控制改进</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#技术分析"><span class="nav-number">4.</span> <span class="nav-text">技术分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#主页面"><span class="nav-number">4.1.</span> <span class="nav-text">主页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#标签页"><span class="nav-number">4.1.1.</span> <span class="nav-text">标签页</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#搜索栏"><span class="nav-number">4.1.2.</span> <span class="nav-text">搜索栏</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#搜索页面"><span class="nav-number">4.2.</span> <span class="nav-text">搜索页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#搜索栏-1"><span class="nav-number">4.2.1.</span> <span class="nav-text">搜索栏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#节目缩略图"><span class="nav-number">4.2.2.</span> <span class="nav-text">节目缩略图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#播放页面"><span class="nav-number">4.3.</span> <span class="nav-text">播放页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#回看标签"><span class="nav-number">4.3.1.</span> <span class="nav-text">回看标签</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#回看节目栏"><span class="nav-number">4.3.2.</span> <span class="nav-text">回看节目栏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#弹幕-评论区"><span class="nav-number">4.3.3.</span> <span class="nav-text">弹幕/评论区</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#弹幕-评论输入栏"><span class="nav-number">4.3.4.</span> <span class="nav-text">弹幕/评论输入栏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#弹幕-评论发送按钮"><span class="nav-number">4.3.5.</span> <span class="nav-text">弹幕/评论发送按钮</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#视频播放器"><span class="nav-number">4.3.6.</span> <span class="nav-text">视频播放器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#（扩展）弹幕显示层"><span class="nav-number">4.3.7.</span> <span class="nav-text">（扩展）弹幕显示层</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#总结"><span class="nav-number">5.</span> <span class="nav-text">总结</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">G1NTOKI</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  





  

  

  

  
  

  

  

  

</body>
</html>
